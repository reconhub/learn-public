<pre><code>---
title: Reconstructing a simulated Ebola outbreak
author: Thibaut Jombart, Finlay Campbell
categories: [&quot;practical&quot;]
tags: [&quot;genetics&quot;, &quot;simulation&quot;, &quot;response&quot;, &quot;outbreaker2&quot;]
date: 2017-11-21T14:00:00-00:00
image: img/highres/ebola.jpg
slug: simulated-evd-reconstruction
showonlyimage: true
---






This case study simulates the early assessment and reconstruction of an Ebola
Virus Disease (EVD) outbreak. It covers various aspects of analysis of the early
stage of an outbreak, and provides an introduction to transmission chain
reconstruction using *outbreaker2*.


          &lt;br&gt;

          # Installing required packages

          The following packages, available on CRAN, are needed for this case study:

          - [`xlsx`](http://www.repidemicsconsortium.org/incidence/) to read `.xlsx` files
          - [`incidence`](http://www.repidemicsconsortium.org/incidence/) for epicurves
          - [`epicontacts`](http://www.repidemicsconsortium.org/epicontacts/) for contact data visualisation
            
            To install these packages, use `install.packages`, e.g.:
               
               
               ```r
               install.packages(&quot;xlsx&quot;)
               install.packages(&quot;incidence&quot;)
               install.packages(&quot;epicontacts&quot;)
               ```

We will also use several packages currently under development, hosted on *github*. These include:
   
   - [`distcrete`](http://www.repidemicsconsortium.org/distcrete) to obtain discrete time delay distributions
   - [`epitrix`](http://www.repidemicsconsortium.org/epitrix) for some practical tricks
   - [`earlyR`](http://www.repidemicsconsortium.org/earlyR) to estimate $R_0$ 
   - [`projections`](http://www.repidemicsconsortium.org/projections) to derive short term incidence predictions
   - [`outbreaker2`](http://www.repidemicsconsortium.org/outbreaker2) to reconstruct the outbreak
      
         
     To install these, you will need a working version of `devtools`, and the
     toolchain for package building on your system. On windows, you will likely need
     to install [*Rtools*](https://cran.r-project.org/bin/windows/Rtools/).
        
        
        ```r
        devtools::install_github(&quot;reconhub/distcrete&quot;)
        devtools::install_github(&quot;reconhub/epitrix&quot;)
        devtools::install_github(&quot;reconhub/earlyR&quot;)
        devtools::install_github(&quot;reconhub/projections&quot;)
        devtools::install_github(&quot;reconhub/outbreaker2&quot;)
        ```



    # A novel EVD outbreak in Ankh, Republic of Morporkia

    A new EVD outbreak has been notified in the small city of Ankh, located in the
    Northern, rural district of the Republic of Morporkia. Public Health Morporkia
    (PHM) is in charge of coordinating the outbreak response, and have contracted
    you as a consultant in epidemics analysis to inform the response in real time.

    &lt;br&gt;
        
        While a new data update is pending, you have been given the following linelist
        and contact data, from the early stages of the outbreak:

        - [**PHM-EVD-linelist-2017-10-27.xlsx**](../../data/PHM-EVD-linelist-2017-10-27.xlsx):
          a linelist containing case information up to the 27th October 2017

          - [**PHM-EVD-contacts-2017-10-27.xlsx**](../../data/PHM-EVD-contacts-2017-10-27.xlsx):
            a list of contacts reported between cases up to the 27th October 2017, where
              `from` indicates a potential source of infection, and `to` the recipient of
                the contact.
              

              To read into R, download these files and use the function `read.xlsx()` from the
              `xlsx` package to import the data. Each import will create a `data.frame`. Call
              the first one `linelist`, and the second one `contacts`. For instance, you first
              command line could look like:
                
                    
                    ```r
                    linelist &lt;- xlsx::read.xlsx(&quot;PHM-EVD-linelist-2017-10-27.xlsx&quot;, sheetIndex = 1)
                    ```


Once imported, the data should look like:
     
     
     ```r
     linelist
     ##        id      onset    sex age
     ## 1  c61339 2017-10-13 female  64
     ## 2  b8551b 2017-10-19 female  23
     ## 3  1b6cc2 2017-10-20 female  51
     ## 4  947e40 2017-10-21   male  57
     ## 5  e4b0a2 2017-10-23   male  32
     ## 6  af0ac0 2017-10-23 female  54
     ## 7  d53618 2017-10-24 female  11
     ## 8  601d2e 2017-10-24   male  23
     ## 9  605322 2017-10-24   male  26
     ## 10 e399b1 2017-10-25 female  18
     ## 11 3d8cf7 2017-10-25 female  16
     ## 12 cca468 2017-10-26   male  27
     contacts
     ##      from     to
     ## 1  947e40 605322
     ## 2  1b6cc2 d53618
     ## 3  c61339 1b6cc2
     ## 4  c61339 e399b1
     ## 5  947e40 af0ac0
     ## 6  c61339 947e40
     ## 7  c61339 cca468
     ## 8  1b6cc2 601d2e
     ## 9  c61339 e4b0a2
     ## 10 c61339 b8551b
     ## 11 c61339 3d8cf7
     ```


   plot(make_epicontacts(linelist, contacts), node_shape = &quot;sex&quot;, shapes = c(male = &quot;male&quot;, female = &quot;female&quot;))</code></pre>
