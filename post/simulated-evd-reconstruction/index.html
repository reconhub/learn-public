<!DOCTYPE html>
<html lang="en-us">
  <head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

 <title>Ebola simulation: outbreak reconstruction</title>



<meta name="description" content="RECON&#39;s teaching platform">


<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="robots" content="all,follow">
<meta name="googlebot" content="index,follow,snippet,archive">

<link rel="stylesheet" href="/css/bootstrap.min.css">
<link rel="stylesheet" id="ct-tracks-google-fonts-css" href="//fonts.googleapis.com/css?family=Raleway%3A400%2C700&amp;subset=latin%2Clatin-ext&amp;ver=4.7.2" type="text/css" media="all">
<link rel="stylesheet" href="/css/font-awesome.min.css">

<link href="/css/style.default.css" rel="stylesheet" id="theme-stylesheet">

<link href="/css/custom.css" rel="stylesheet">
<link rel="shortcut icon" href="/img/favicon.png">




<link rel="stylesheet" href="/css/recon.css">
<script src="/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</head>
  <body>
    <div id="root">
      <div class="container-fluid">
        <div class="row site-header">
          <div class="col-md-12">
            <div class="row">
              <div class="col-md-12 top-navigation">
                <div class="row">
  <div class="col-sm-6">
    <div class="categories-block">
      <a href="/" class="track-categories">Home</a>
      
      <a href="/categories/lectures">lectures</a>
      
      <a href="/categories/practicals">practicals</a>
      
    </div>
  </div>

  <div class="col-sm-6">
    <div class="social-media-block">

      
      
      
      <a href="https://twitter.com/teebzr" data-animate-hover="pulse" class="external twitter">
        <i class="fa fa-twitter"></i>
      </a>
      
      
      
      <a href="mailto:thibautjombart@gmail.com" data-animate-hover="pulse" class="email">
        <i class="fa fa-envelope"></i>
      </a>
      
      
      
      
      <a href="https://github.com/reconhub/learn" data-animate-hover="pulse">
        <i class="fa fa-github"></i>
      </a>
      

    </div>
  </div>
</div>

              </div>
            </div>
            <div class="row">
              <div class="col-md-10 header col-md-offset-1">
                
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  




              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-md-10 main-content col-md-offset-1">
            

<div class="col-md-12 entry">
  <div class="row">
    <div class="col-md-12">
      <div class="entry-meta">
        November 22
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-md-12">
      <div class="entry-header">
       Ebola simulation: outbreak reconstruction
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-md-2">
      <div class="entry-sidebar">
        <div class="entry-sidebar-title">CATEGORIES</div>
        
        <div class="entry-categories">
          <a href="/categories/lectures">lectures</a>
        </div>
        
        <div class="entry-categories">
          <a href="/categories/practicals">practicals</a>
        </div>
        

        <div class="entry-sidebar-title">Tags</div>
        
        <div class="entry-tags">
          <a href="/tags/chagas">chagas</a>
        </div>
        
        <div class="entry-tags">
          <a href="/tags/compartmental-models">compartmental-models</a>
        </div>
        
        <div class="entry-tags">
          <a href="/tags/delays">delays</a>
        </div>
        
        <div class="entry-tags">
          <a href="/tags/ebola">ebola</a>
        </div>
        
        <div class="entry-tags">
          <a href="/tags/epicurve">epicurve</a>
        </div>
        
        <div class="entry-tags">
          <a href="/tags/epicurves">epicurves</a>
        </div>
        
        <div class="entry-tags">
          <a href="/tags/forecasting">forecasting</a>
        </div>
        
        <div class="entry-tags">
          <a href="/tags/genetics">genetics</a>
        </div>
        
        <div class="entry-tags">
          <a href="/tags/incidence">incidence</a>
        </div>
        
        <div class="entry-tags">
          <a href="/tags/malaria">malaria</a>
        </div>
        
        <div class="entry-tags">
          <a href="/tags/modelling">modelling</a>
        </div>
        
        <div class="entry-tags">
          <a href="/tags/outbreaker2">outbreaker2</a>
        </div>
        
        <div class="entry-tags">
          <a href="/tags/public-health">public-health</a>
        </div>
        
        <div class="entry-tags">
          <a href="/tags/reconstruction">reconstruction</a>
        </div>
        
        <div class="entry-tags">
          <a href="/tags/reproduction-number">reproduction-number</a>
        </div>
        
        <div class="entry-tags">
          <a href="/tags/response">response</a>
        </div>
        
        <div class="entry-tags">
          <a href="/tags/rmarkdown">rmarkdown</a>
        </div>
        
        <div class="entry-tags">
          <a href="/tags/simulation">simulation</a>
        </div>
        
        <div class="entry-tags">
          <a href="/tags/vdb">vdb</a>
        </div>
        
        <div class="entry-tags">
          <a href="/tags/zika">zika</a>
        </div>
        
      </div>
    </div>
    <div class="col-md-10">
      <div class="entry-content">
        <script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<link href="/rmarkdown-libs/vis/vis.css" rel="stylesheet" />
<script src="/rmarkdown-libs/vis/vis.min.js"></script>
<script src="/rmarkdown-libs/visNetwork-binding/visNetwork.js"></script>
<link href="/rmarkdown-libs/font-awesome/css/font-awesome.min.css" rel="stylesheet" />


<p>This practical is the second part of the response to a simulated Ebola Virus Disease (EVD) outbreak taking place in the city of Ankh, Republic of Morporkia. While the <a href="../simulated-evd-early"><strong>first part</strong></a> focussed on early assessments of transmissibility, this part provides an introduction to outbreak reconstruction using <em>outbreaker2</em>.</p>
<p><br></p>
<div id="installing-required-packages" class="section level1">
<h1>Installing required packages</h1>
<p>The following packages, available on CRAN, are needed for this case study:</p>
<ul>
<li><a href="http://www.repidemicsconsortium.org/incidence/"><code>xlsx</code></a> to read <code>.xlsx</code> files</li>
<li><a href="http://www.repidemicsconsortium.org/incidence/"><code>incidence</code></a> for epicurves</li>
<li><a href="http://www.repidemicsconsortium.org/epicontacts/"><code>epicontacts</code></a> for contact data visualisation</li>
</ul>
<p>To install these packages, use <code>install.packages</code>, e.g.:</p>
<pre class="r"><code>install.packages(&quot;xlsx&quot;)
install.packages(&quot;incidence&quot;)
install.packages(&quot;epicontacts&quot;)</code></pre>
<p>We will also use several packages currently under development, hosted on <em>github</em>. These include:</p>
<ul>
<li><a href="http://www.repidemicsconsortium.org/distcrete"><code>distcrete</code></a> to obtain discrete time delay distributions</li>
<li><a href="http://www.repidemicsconsortium.org/epitrix"><code>epitrix</code></a> for some practical tricks</li>
<li><a href="http://www.repidemicsconsortium.org/outbreaker2"><code>outbreaker2</code></a> to reconstruct the outbreak</li>
</ul>
<p>To install these, you will need a working version of <code>devtools</code>, and the toolchain for package building on your system. On windows, you will likely need to install <a href="https://cran.r-project.org/bin/windows/Rtools/"><em>Rtools</em></a>.</p>
<pre class="r"><code>devtools::install_github(&quot;reconhub/distcrete&quot;)
devtools::install_github(&quot;reconhub/epitrix&quot;)
devtools::install_github(&quot;reconhub/outbreaker2&quot;)</code></pre>
</div>
<div id="an-update-on-the-evd-outbreak-in-ankh-republic-of-morporkia" class="section level1">
<h1>An update on the EVD outbreak in Ankh, Republic of Morporkia</h1>
<p>After some rather concerning <a href="../simulated-evd-early">preliminary results</a> on the new EVD outbreak in the city of Ankh, Republic of Morporkia, Public Health Morporkia (PHM) has sent you updates of the linelists and contact data. This time, PHM has also obtained Whole Genome Sequences (WGS) of the Ebola virus isolated in patients.</p>
<div id="the-new-data" class="section level2">
<h2>The new data</h2>
<p>The data update includes new linelists and contact lists:</p>
<ul>
<li><p><a href="../../data/PHM-EVD-linelist-2017-11-25.xlsx"><strong>PHM-EVD-linelist-2017-11-25.xlsx</strong></a>: a linelist containing case information up to the 25th November 2017</p></li>
<li><p><a href="../../data/PHM-EVD-contacts-2017-11-25.xlsx"><strong>PHM-EVD-contacts-2017-11-25.xlsx</strong></a>: a list of contacts reported between cases up to the 25th November, where <code>from</code> indicates a potential source of infection, and <code>to</code> the recipient of the contact.</p></li>
</ul>
<p>To read into R, download these files and use the function <code>read.xlsx()</code> from the <code>xlsx</code> package to import the data. Each import will create a <code>data.frame</code>. Call the first one <code>linelist</code>, and the second one <code>contacts</code>. For instance, your first command line could look like:</p>
<pre class="r"><code>linelist &lt;- xlsx::read.xlsx(&quot;PHM-EVD-linelist-2017-11-25.xlsx&quot;, sheetIndex = 1, stringsAsFactors = FALSE)</code></pre>
<p>Once imported, the data should look like:</p>
<pre class="r"><code>
## linelist: one line per case
head(linelist)
##   case_id      onset    sex age
## 1  39e9dc 2017-10-10 female  62
## 2  664549 2017-10-16   male  28
## 3  b4d8aa 2017-10-17   male  54
## 4  51883d 2017-10-18   male  57
## 5  947e40 2017-10-20 female  23
## 6  9aa197 2017-10-20 female  66


## contacts: pairs of cases with reported contacts
head(contacts)
##     from     to
## 1 9aa197 426b6d
## 2 39e9dc a8e9d8
## 3 c2a389 95fc1d
## 4 51883d 778316
## 5 51883d e37897
## 6 933811 99abbe</code></pre>
</div>
<div id="a-first-look-at-contacts" class="section level2">
<h2>A first look at contacts</h2>
<p>Contact tracing is at the centre of an Ebola outbreak response. Using the function <code>make_epicontacts</code> in the <code>epicontacts</code> package, create a new <code>epicontacts</code> object called <code>x</code>. The result should look like:</p>
<pre class="r"><code>x
## 
## /// Epidemiological Contacts //
## 
##   // class: epicontacts
##   // 50 cases in linelist; 36 contacts;  directed 
## 
##   // linelist
## 
## # A tibble: 50 x 4
##        id      onset    sex   age
##  *  &lt;chr&gt;     &lt;date&gt;  &lt;chr&gt; &lt;dbl&gt;
##  1 39e9dc 2017-10-10 female    62
##  2 664549 2017-10-16   male    28
##  3 b4d8aa 2017-10-17   male    54
##  4 51883d 2017-10-18   male    57
##  5 947e40 2017-10-20 female    23
##  6 9aa197 2017-10-20 female    66
##  7 e4b0a2 2017-10-21 female    13
##  8 af0ac0 2017-10-21   male    10
##  9 185911 2017-10-21 female    34
## 10 601d2e 2017-10-22   male    11
## # ... with 40 more rows
## 
##   // contacts
## 
## # A tibble: 36 x 2
##      from     to
##     &lt;chr&gt;  &lt;chr&gt;
##  1 9aa197 426b6d
##  2 39e9dc a8e9d8
##  3 c2a389 95fc1d
##  4 51883d 778316
##  5 51883d e37897
##  6 933811 99abbe
##  7 51883d 185911
##  8 b4d8aa e4b0a2
##  9 605322 1875e2
## 10 b4d8aa b5ad13
## # ... with 26 more rows</code></pre>
<p>You can easily plot these contacts, but with a little bit of tweaking (see <code>?vis_epicontacts</code>) you can customise shapes by gender:</p>
<pre class="r"><code>plot(x, node_shape = &quot;sex&quot;, shapes = c(male = &quot;male&quot;, female = &quot;female&quot;), selector = FALSE)</code></pre>
<div id="htmlwidget-1" style="width:90%;height:700px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"nodes":{"id":["185911","1875e2","1b035f","1efd54","39e9dc","3a5305","426b6d","4945f2","501b8f","51883d","55a452","59e66c","5eb2b0","601d2e","605322","6f3c15","778316","88526e","8bed66","8c5776","933811","93a3ba","947e40","95fc1d","99141e","99abbe","9aa197","a402f6","a8e9d8","ac8d9d","ae87f7","af0ac0","b4d8aa","b5ad13","bcfad3","c2a389","d5564e","e37897","e399b1","e4b0a2","f658bc"],"onset":["2017-10-21","2017-11-16","2017-11-04","2017-11-04","2017-10-10","2017-11-13","2017-11-08","2017-11-16","2017-11-05","2017-10-18","2017-11-14","2017-11-16","2017-11-13","2017-10-22","2017-10-22","2017-10-29","2017-11-04","2017-11-03","2017-11-08","2017-11-02","2017-11-16","2017-11-10","2017-10-20","2017-11-19","2017-11-12","2017-11-18","2017-10-20","2017-11-09","2017-10-29","2017-11-23","2017-11-01","2017-10-21","2017-10-17","2017-11-07","2017-11-18","2017-11-10","2017-11-20","2017-10-28","2017-10-23","2017-10-21","2017-10-28"],"sex":["female","male","male","male","female","male","female","male","male","male","female","male","female","male","female","male","female","female","female","female","male","male","female","female","male","male","female","male","female","female","male","male","male","female","female","female","female","female","female","female","male"],"age":[34,30,29,8,62,29,7,19,23,57,33,9,7,11,23,13,10,20,29,7,16,7,23,15,15,14,66,26,37,5,25,10,54,21,31,26,43,9,23,13,68],"label":["185911","1875e2","1b035f","1efd54","39e9dc","3a5305","426b6d","4945f2","501b8f","51883d","55a452","59e66c","5eb2b0","601d2e","605322","6f3c15","778316","88526e","8bed66","8c5776","933811","93a3ba","947e40","95fc1d","99141e","99abbe","9aa197","a402f6","a8e9d8","ac8d9d","ae87f7","af0ac0","b4d8aa","b5ad13","bcfad3","c2a389","d5564e","e37897","e399b1","e4b0a2","f658bc"],"title":["<p> id: 185911<br>onset: 2017-10-21<br>sex: female<br>age: 34 <\/p>","<p> id: 1875e2<br>onset: 2017-11-16<br>sex: male<br>age: 30 <\/p>","<p> id: 1b035f<br>onset: 2017-11-04<br>sex: male<br>age: 29 <\/p>","<p> id: 1efd54<br>onset: 2017-11-04<br>sex: male<br>age: 8 <\/p>","<p> id: 39e9dc<br>onset: 2017-10-10<br>sex: female<br>age: 62 <\/p>","<p> id: 3a5305<br>onset: 2017-11-13<br>sex: male<br>age: 29 <\/p>","<p> id: 426b6d<br>onset: 2017-11-08<br>sex: female<br>age: 7 <\/p>","<p> id: 4945f2<br>onset: 2017-11-16<br>sex: male<br>age: 19 <\/p>","<p> id: 501b8f<br>onset: 2017-11-05<br>sex: male<br>age: 23 <\/p>","<p> id: 51883d<br>onset: 2017-10-18<br>sex: male<br>age: 57 <\/p>","<p> id: 55a452<br>onset: 2017-11-14<br>sex: female<br>age: 33 <\/p>","<p> id: 59e66c<br>onset: 2017-11-16<br>sex: male<br>age: 9 <\/p>","<p> id: 5eb2b0<br>onset: 2017-11-13<br>sex: female<br>age: 7 <\/p>","<p> id: 601d2e<br>onset: 2017-10-22<br>sex: male<br>age: 11 <\/p>","<p> id: 605322<br>onset: 2017-10-22<br>sex: female<br>age: 23 <\/p>","<p> id: 6f3c15<br>onset: 2017-10-29<br>sex: male<br>age: 13 <\/p>","<p> id: 778316<br>onset: 2017-11-04<br>sex: female<br>age: 10 <\/p>","<p> id: 88526e<br>onset: 2017-11-03<br>sex: female<br>age: 20 <\/p>","<p> id: 8bed66<br>onset: 2017-11-08<br>sex: female<br>age: 29 <\/p>","<p> id: 8c5776<br>onset: 2017-11-02<br>sex: female<br>age: 7 <\/p>","<p> id: 933811<br>onset: 2017-11-16<br>sex: male<br>age: 16 <\/p>","<p> id: 93a3ba<br>onset: 2017-11-10<br>sex: male<br>age: 7 <\/p>","<p> id: 947e40<br>onset: 2017-10-20<br>sex: female<br>age: 23 <\/p>","<p> id: 95fc1d<br>onset: 2017-11-19<br>sex: female<br>age: 15 <\/p>","<p> id: 99141e<br>onset: 2017-11-12<br>sex: male<br>age: 15 <\/p>","<p> id: 99abbe<br>onset: 2017-11-18<br>sex: male<br>age: 14 <\/p>","<p> id: 9aa197<br>onset: 2017-10-20<br>sex: female<br>age: 66 <\/p>","<p> id: a402f6<br>onset: 2017-11-09<br>sex: male<br>age: 26 <\/p>","<p> id: a8e9d8<br>onset: 2017-10-29<br>sex: female<br>age: 37 <\/p>","<p> id: ac8d9d<br>onset: 2017-11-23<br>sex: female<br>age: 5 <\/p>","<p> id: ae87f7<br>onset: 2017-11-01<br>sex: male<br>age: 25 <\/p>","<p> id: af0ac0<br>onset: 2017-10-21<br>sex: male<br>age: 10 <\/p>","<p> id: b4d8aa<br>onset: 2017-10-17<br>sex: male<br>age: 54 <\/p>","<p> id: b5ad13<br>onset: 2017-11-07<br>sex: female<br>age: 21 <\/p>","<p> id: bcfad3<br>onset: 2017-11-18<br>sex: female<br>age: 31 <\/p>","<p> id: c2a389<br>onset: 2017-11-10<br>sex: female<br>age: 26 <\/p>","<p> id: d5564e<br>onset: 2017-11-20<br>sex: female<br>age: 43 <\/p>","<p> id: e37897<br>onset: 2017-10-28<br>sex: female<br>age: 9 <\/p>","<p> id: e399b1<br>onset: 2017-10-23<br>sex: female<br>age: 23 <\/p>","<p> id: e4b0a2<br>onset: 2017-10-21<br>sex: female<br>age: 13 <\/p>","<p> id: f658bc<br>onset: 2017-10-28<br>sex: male<br>age: 68 <\/p>"],"icon.color":["#CCDDFF","#B9DAEA","#A6D8D6","#93D5C2","#81D3AE","#89CEA7","#A7C7AA","#C6C0AD","#E4B9B0","#FCB2B3","#E8AFB6","#D3ABB9","#BFA8BC","#AAA5BF","#B1AAA4","#C6B378","#DABC4D","#EFC521","#FFC906","#FFBF23","#FFB540","#FFAB5C","#FFA179","#F6AF84","#EAC58A","#DFDB8F","#D3F095","#CDF79B","#D1E2A4","#D5CCAC","#DAB6B5","#DEA1BE","#E5A8B7","#ECB2AE","#F3BCA6","#FBC69D","#F9CC9E","#EECCA9","#E3CCB5","#D8CCC1","#CDCDCD"],"group.color":["#CCDDFF","#B9DAEA","#A6D8D6","#93D5C2","#81D3AE","#89CEA7","#A7C7AA","#C6C0AD","#E4B9B0","#FCB2B3","#E8AFB6","#D3ABB9","#BFA8BC","#AAA5BF","#B1AAA4","#C6B378","#DABC4D","#EFC521","#FFC906","#FFBF23","#FFB540","#FFAB5C","#FFA179","#F6AF84","#EAC58A","#DFDB8F","#D3F095","#CDF79B","#D1E2A4","#D5CCAC","#DAB6B5","#DEA1BE","#E5A8B7","#ECB2AE","#F3BCA6","#FBC69D","#F9CC9E","#EECCA9","#E3CCB5","#D8CCC1","#CDCDCD"],"shape":["icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon"],"icon.code":["f182","f183","f183","f183","f182","f183","f182","f183","f183","f183","f182","f183","f182","f183","f182","f183","f182","f182","f182","f182","f183","f183","f182","f182","f183","f183","f182","f183","f182","f182","f183","f183","f183","f182","f182","f182","f182","f182","f182","f182","f183"]},"edges":{"from":["9aa197","39e9dc","c2a389","51883d","51883d","933811","51883d","b4d8aa","605322","b4d8aa","b4d8aa","f658bc","51883d","1b035f","c2a389","9aa197","51883d","778316","9aa197","b4d8aa","39e9dc","5eb2b0","39e9dc","88526e","39e9dc","9aa197","b4d8aa","778316","39e9dc","9aa197","1efd54","f658bc","b4d8aa","c2a389","39e9dc","a8e9d8"],"to":["426b6d","a8e9d8","95fc1d","778316","e37897","99abbe","185911","e4b0a2","1875e2","b5ad13","55a452","ae87f7","6f3c15","8bed66","99141e","d5564e","501b8f","93a3ba","88526e","3a5305","b4d8aa","4945f2","601d2e","5eb2b0","e399b1","f658bc","af0ac0","a402f6","947e40","8c5776","59e66c","1b035f","bcfad3","ac8d9d","605322","933811"],"width":[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],"arrows":["to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false},"physics":{"stabilization":false}},"groups":["#CCDDFF","#B9DAEA","#A6D8D6","#93D5C2","#81D3AE","#89CEA7","#A7C7AA","#C6C0AD","#E4B9B0","#FCB2B3","#E8AFB6","#D3ABB9","#BFA8BC","#AAA5BF","#B1AAA4","#C6B378","#DABC4D","#EFC521","#FFC906","#FFBF23","#FFB540","#FFAB5C","#FFA179","#F6AF84","#EAC58A","#DFDB8F","#D3F095","#CDF79B","#D1E2A4","#D5CCAC","#DAB6B5","#DEA1BE","#E5A8B7","#ECB2AE","#F3BCA6","#FBC69D","#F9CC9E","#EECCA9","#E3CCB5","#D8CCC1","#CDCDCD"],"width":"90%","height":"700px","idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)"},"main":null,"submain":null,"footer":null,"legend":{"width":0.2,"useGroups":false,"position":"left","ncol":1,"stepX":100,"stepY":100},"highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null},"iconsRedraw":true},"evals":[],"jsHooks":[]}</script>
<p><strong>What can you say about these contacts?</strong></p>
</div>
<div id="looking-at-incidence-curves" class="section level2">
<h2>Looking at incidence curves</h2>
<p>The first question PHM asks you is simply: <em>how bad is it?</em>. Given that this is a terrible disease, with a mortality rate nearing 70%, there is a lot of concern about this outbreak getting out of control. The first step of the analysis lies in drawing an <em>epicurve</em>, i.e.Â an plot of incidence over time.</p>
<p><br></p>
<p>Using the package <code>incidence</code>, compute daily incidence based on the dates of symptom onset. Store the result in an object called <code>i</code>; the result should look like:</p>
<pre class="r"><code>i
## &lt;incidence object&gt;
## [50 cases from days 2017-10-10 to 2017-11-24]
## 
## $counts: matrix with 46 rows and 1 columns
## $n: 50 cases in total
## $dates: 46 dates marking the left-side of bins
## $interval: 1 day
## $timespan: 46 days
plot(i)
## Warning in plyr::split_indices(scale_id, n): &#39;.Random.seed&#39; is not an
## integer vector but of type &#39;NULL&#39;, so ignored</code></pre>
<p><img src="/post/2017-11-22-sim-ebola-reconstruction_files/figure-html/incidence-1.png" width="672" /></p>
</div>
<div id="outbreak-reconstruction-using-onset-and-contact-data" class="section level2">
<h2>Outbreak reconstruction using onset and contact data</h2>
<pre class="r"><code>library(epitrix)
library(distcrete)

mu &lt;- 15.3
sd &lt;- 9.3
si_params &lt;- epitrix::gamma_mucv2shapescale(mu, sd / mu)
si_params
## $shape
## [1] 2.706556
## 
## $scale
## [1] 5.652941
si &lt;- distcrete(&quot;gamma&quot;, shape = si_params$shape, scale = si_params$scale, interval = 1L, w = 0)
plot(si$d, type = &quot;h&quot;, xlim = c(0,50), col = &quot;navy&quot;, lwd = 2,
     xlab = &quot;Days after symptoms&quot;, ylab = &quot;Probability&quot;,
     main = &quot;Serial interval distribution&quot;)</code></pre>
<p><img src="/post/2017-11-22-sim-ebola-reconstruction_files/figure-html/si-1.png" width="672" /></p>
<pre class="r"><code>library(outbreaker2)

ctd &lt;- matrix(match(unlist(contacts), linelist$case_id), ncol = 2)
data &lt;- outbreaker_data(dates = linelist$onset, ctd = ctd, w_dens = si$d(1:100))
config &lt;- create_config(move_kappa = FALSE, move_pi = FALSE, find_import = FALSE)

res_time_ctd &lt;- outbreaker(data = data, config = config)
## Can&#39;t use seqTrack initialization with missing DNA sequences; using a star-like tree
res_time_ctd
## 
## 
##  ///// outbreaker results ///
## 
## class:  outbreaker_chains data.frame
## dimensions 201 rows,  158 columns
## ancestries not shown: alpha_1 - alpha_50
## infection dates not shown: t_inf_1 - t_inf_50
## intermediate generations not shown: kappa_1 - kappa_50
## 
## /// head //
##   step      post      like   prior    mu  pi       eps     lambda
## 1    1 -545.6598 -547.0141 1.35424 1e-04 0.9 0.5000000 0.05000000
## 2   50 -470.5297 -471.8839 1.35424 1e-04 0.9 0.2586771 0.06239704
## 3  100 -423.1901 -424.5443 1.35424 1e-04 0.9 0.4996598 0.02310634
## 
## ...
## /// tail //
##      step      post      like   prior    mu  pi       eps       lambda
## 199  9900 -383.9566 -385.3108 1.35424 1e-04 0.9 0.5975478 0.0004420433
## 200  9950 -383.7498 -385.1041 1.35424 1e-04 0.9 0.6931803 0.0025707301
## 201 10000 -380.3590 -381.7132 1.35424 1e-04 0.9 0.8034187 0.0014675710</code></pre>
<p>See <code>?plot.outbreaker_chains</code> for details on available plots.</p>
<pre class="r"><code># plot(res_time_ctd)</code></pre>
<pre class="r"><code># plot(res_time_ctd,  type = &quot;alpha&quot;, burnin = 1000)</code></pre>
<pre class="r"><code># plot(res_time_ctd,  type = &quot;t_inf&quot;, burnin = 1000)</code></pre>
<pre class="r"><code>outbreaker2:::plot.outbreaker_chains(res_time_ctd,  type = &quot;network&quot;, burnin = 1000, min_support = .05)</code></pre>
<div id="htmlwidget-2" style="width:672px;height:480px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-2">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50],"label":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50],"value":[7.17222222222222,0.472222222222222,6.47222222222222,4.82777777777778,0.594444444444444,4.5,0.311111111111111,0.333333333333333,0.638888888888889,0.466666666666667,1.43333333333333,0.494444444444444,0.294444444444444,2.85555555555556,1.32222222222222,0.433333333333333,0.322222222222222,0.222222222222222,0.272222222222222,1.21666666666667,1.43333333333333,1.07222222222222,2.47222222222222,0.233333333333333,0.188888888888889,0.255555555555556,0.227777777777778,0.277777777777778,0.205555555555556,2.48333333333333,0.194444444444444,0.205555555555556,0.116666666666667,1.1,0.211111111111111,0.211111111111111,0.1,0.0833333333333333,0.161111111111111,0.244444444444444,1.12777777777778,0.283333333333333,0.111111111111111,0.0777777777777778,0.0888888888888889,0.644444444444444,0.122222222222222,0.222222222222222,0.0777777777777778,0.111111111111111],"color":["#CCDDFF","#BCDAEE","#ADD8DE","#9ED6CD","#8FD4BD","#7FD2AD","#86CEA7","#9FC9A9","#B7C3AC","#D0BDAE","#E9B8B0","#FDB2B3","#ECAFB5","#DBADB8","#CBAABB","#BAA7BD","#A9A4C0","#AFA8A9","#BFB085","#D0B762","#E1BE3F","#F2C61B","#FFCA05","#FFC11C","#FFB934","#FFB14B","#FFA963","#FFA07A","#F7AC83","#EEBE88","#E4CF8C","#DBE191","#D2F395","#CDF99B","#D0E7A2","#D4D5A9","#D7C4B0","#DBB2B7","#DEA0BE","#E4A6B8","#EAAEB1","#EFB6AA","#F5BFA3","#FBC79C","#FACC9D","#F1CCA6","#E8CCB0","#DFCCB9","#D6CCC3","#CDCDCD"],"shape":["dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot"],"shaped":["star",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]},"edges":{"from":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,5,6,6,6,6,6,9,10,10,11,11,12,12,14,14,14,15,16,17,20,21,21,22,22,23,23,23,28,30,30,30,32,34,40,41,46],"to":[2,3,4,5,6,9,10,11,12,14,15,16,21,23,18,2,7,8,14,26,35,36,42,2,9,13,16,23,24,25,2,14,19,20,28,48,4,2,18,18,39,2,18,6,17,21,41,4,47,34,14,27,37,40,4,29,31,45,32,46,49,30,38,22,43,30],"value":[0.244444444444444,0.994444444444444,0.2,1,0.0777777777777778,0.133333333333333,0.988888888888889,1,0.994444444444444,0.155555555555556,0.988888888888889,0.0833333333333333,0.127777777777778,0.0722222222222222,0.0555555555555556,0.105555555555556,0.988888888888889,0.988888888888889,0.0777777777777778,0.983333333333333,0.961111111111111,0.955555555555556,0.972222222222222,0.0611111111111111,0.677777777777778,0.955555555555556,0.877777777777778,0.844444444444444,0.994444444444444,0.0777777777777778,0.116666666666667,0.288888888888889,1,0.983333333333333,0.955555555555556,0.994444444444444,0.311111111111111,0.0666666666666667,0.0611111111111111,0.0611111111111111,0.988888888888889,0.0777777777777778,0.0722222222222222,0.688888888888889,0.972222222222222,0.794444444444444,0.944444444444444,0.122222222222222,0.0555555555555556,0.95,0.183333333333333,0.961111111111111,0.0777777777777778,0.833333333333333,0.127777777777778,0.994444444444444,0.983333333333333,0.0555555555555556,0.866666666666667,0.472222222222222,0.977777777777778,0.122222222222222,0.916666666666667,0.144444444444444,0.922222222222222,0.505555555555556],"arrows":["to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to"],"color":["#CCDDFF","#CCDDFF","#CCDDFF","#CCDDFF","#CCDDFF","#CCDDFF","#CCDDFF","#CCDDFF","#CCDDFF","#CCDDFF","#CCDDFF","#CCDDFF","#CCDDFF","#CCDDFF","#BCDAEE","#ADD8DE","#ADD8DE","#ADD8DE","#ADD8DE","#ADD8DE","#ADD8DE","#ADD8DE","#ADD8DE","#9ED6CD","#9ED6CD","#9ED6CD","#9ED6CD","#9ED6CD","#9ED6CD","#9ED6CD","#8FD4BD","#7FD2AD","#7FD2AD","#7FD2AD","#7FD2AD","#7FD2AD","#B7C3AC","#D0BDAE","#D0BDAE","#E9B8B0","#E9B8B0","#FDB2B3","#FDB2B3","#DBADB8","#DBADB8","#DBADB8","#CBAABB","#BAA7BD","#A9A4C0","#D0B762","#E1BE3F","#E1BE3F","#F2C61B","#F2C61B","#FFCA05","#FFCA05","#FFCA05","#FFA07A","#EEBE88","#EEBE88","#EEBE88","#DBE191","#CDF99B","#E4A6B8","#EAAEB1","#F1CCA6"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","color":{"highlight":"red"},"shadow":{"enabled":true,"size":10}},"manipulation":{"enabled":false},"edges":{"arrows":{"to":{"enabled":true,"scaleFactor":0.2}},"color":{"highlight":"red"}}},"groups":null,"width":null,"height":null,"idselection":{"enabled":false},"byselection":{"enabled":false},"main":null,"submain":null,"footer":null},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>smry_time_ctd &lt;- summary(res_time_ctd)
smry_time_ctd
## $step
##    first     last interval  n_steps 
##        1    10000       50      201 
## 
## $post
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  -545.7  -378.4  -371.3  -374.1  -365.3  -353.5 
## 
## $like
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  -547.0  -379.7  -372.6  -375.4  -366.6  -354.8 
## 
## $prior
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   1.354   1.354   1.354   1.354   1.354   1.354 
## 
## $mu
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   1e-04   1e-04   1e-04   1e-04   1e-04   1e-04 
## 
## $pi
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##     0.9     0.9     0.9     0.9     0.9     0.9 
## 
## $tree
##    from to time    support generations
## 1    NA  1  -15         NA          NA
## 2     1  2    0 0.23383085           1
## 3     1  3   -6 0.99502488           1
## 4     9  4   -1 0.37810945           1
## 5     1  5   -3 0.99502488           1
## 6    14  6    3 0.70149254           1
## 7     3  7    3 0.98009950           1
## 8     3  8    2 0.98507463           1
## 9     4  9    1 0.60696517           1
## 10    1 10   -2 0.98507463           1
## 11    1 11    1 0.99502488           1
## 12    1 12   -1 0.99502488           1
## 13    4 13    9 0.95024876           1
## 14    6 14    1 0.25870647           1
## 15    1 15    3 0.98507463           1
## 16    4 16    8 0.87562189           1
## 17   14 17   11 0.95522388           1
## 18    2 18   13 0.06965174           1
## 19    6 19   13 0.99502488           1
## 20    6 20   11 0.95024876           1
## 21   14 21    9 0.71641791           1
## 22   40 22   17 0.15422886           1
## 23    4 23    9 0.85074627           1
## 24    4 24   14 0.98507463           1
## 25    4 25   16 0.07960199           1
## 26    3 26   10 0.97512438           1
## 27   21 27   18 0.86567164           1
## 28    6 28   15 0.95024876           1
## 29   23 29   19 0.98009950           1
## 30   46 30   19 0.45273632           1
## 31   23 31   20 0.97512438           1
## 32   30 32   26 0.86069652           1
## 33    8 33   23 0.03980100           1
## 34   20 34   20 0.94527363           1
## 35    3 35   16 0.95024876           1
## 36    3 36   15 0.95024876           1
## 37   22 37   26 0.06965174           1
## 38   34 38   29 0.90547264           1
## 39   11 39   19 0.97512438           1
## 40   22 40   26 0.81592040           1
## 41   15 41   17 0.93034826           1
## 42    3 42   15 0.96019900           1
## 43   41 43   27 0.90547264           1
## 44   16 44   28 0.03980100           1
## 45   28 45   25 0.05472637           1
## 46   30 46   20 0.51243781           1
## 47   17 47   24 0.05970149           1
## 48    6 48   20 0.98507463           1
## 49   30 49   31 0.96517413           1
## 50   18 50   25 0.03980100           1</code></pre>
</div>
</div>

      </div>
    </div>
  </div>

  <hr/>
  

</div>

          </div>
        </div>
        <div class="row site-footer">
          <div class="col-md-12">
            <div class="row">
  <div class="col-md-12 footer-title">
    <h3 style="color:black">Powered by</h3>
    <a href="http://www.repidemicsconsortium.org/"><img src="/img/logo/recon.png" width="150px"></a>
      
      
      
      
      
  </div>
</div>


















































<script src="//yihui.name/js/math-code.js"></script>
<script async
	src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
</script>






          </div>
        </div>
      </div>
    </div>
    <script src="/js/jquery.min.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/jquery.cookie.js"> </script>
<script src="/js/ekko-lightbox.js"></script>
<script src="/js/jquery.scrollTo.min.js"></script>
<script src="/js/masonry.pkgd.min.js"></script>
<script src="/js/imagesloaded.pkgd.min.js"></script>
<script src="/js/owl.carousel.min.js"></script>
<script src="/js/front.js"></script>

  </body>
</html>
