<!DOCTYPE html>
<html lang="en-us">
  <head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

 <title>Ebola simulation part 2: outbreak reconstruction</title>



<meta name="description" content="RECON&#39;s teaching platform">


<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="robots" content="all,follow">
<meta name="googlebot" content="index,follow,snippet,archive">

<link rel="stylesheet" href="https://reconlearn.netlify.com/css/bootstrap.min.css">
<link rel="stylesheet" id="ct-tracks-google-fonts-css" href="//fonts.googleapis.com/css?family=Raleway%3A400%2C700&amp;subset=latin%2Clatin-ext&amp;ver=4.7.2" type="text/css" media="all">
<link rel="stylesheet" href="https://reconlearn.netlify.com/css/font-awesome.min.css">

<link href="https://reconlearn.netlify.com/css/style.default.css" rel="stylesheet" id="theme-stylesheet">

<link href="https://reconlearn.netlify.com/css/custom.css" rel="stylesheet">
<link rel="shortcut icon" href="https://reconlearn.netlify.com/img/favicon.png">




<link rel="stylesheet" href="https://reconlearn.netlify.com/css/recon.css">
<script src="https://reconlearn.netlify.com/js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
</head>
  <body>
    <div id="root">
      <div class="container-fluid">
        <div class="row site-header">
          <div class="col-md-12">
            <div class="row">
              <div class="col-md-12 top-navigation">
                <div class="row">
  <div class="col-sm-6">
    <div class="categories-block">
      <a href="/" class="track-categories">Home</a>
      
      <a href="/categories/lectures">lectures</a>
      
      <a href="/categories/practicals">practicals</a>
      
    </div>
  </div>

  <div class="col-sm-6">
    <div class="social-media-block">

      
      
      
      <a href="https://twitter.com/teebzr" data-animate-hover="pulse" class="external twitter">
        <i class="fa fa-twitter"></i>
      </a>
      
      
      
      <a href="mailto:thibautjombart@gmail.com" data-animate-hover="pulse" class="email">
        <i class="fa fa-envelope"></i>
      </a>
      
      
      
      
      <a href="https://github.com/reconhub/learn" data-animate-hover="pulse">
        <i class="fa fa-github"></i>
      </a>
      

    </div>
  </div>
</div>

              </div>
            </div>
            <div class="row">
              <div class="col-md-10 header col-md-offset-1">
                
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  




              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-md-10 main-content col-md-offset-1">
            

<div class="col-md-12 entry">
  <div class="row">
    <div class="col-md-12">
      <div class="entry-meta">
        November 22
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-md-12">
      <div class="entry-header">
       Ebola simulation part 2: outbreak reconstruction
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-md-2">
      <div class="entry-sidebar">
        <div class="entry-sidebar-title">CATEGORIES</div>
        
        <div class="entry-categories">
          <a href="/categories/lectures">lectures</a>
        </div>
        
        <div class="entry-categories">
          <a href="/categories/practicals">practicals</a>
        </div>
        

        <div class="entry-sidebar-title">Tags</div>
        
        <div class="entry-tags">
          <a href="/tags/ebola">ebola</a>
        </div>
        
        <div class="entry-tags">
          <a href="/tags/epicurve">epicurve</a>
        </div>
        
        <div class="entry-tags">
          <a href="/tags/genetics">genetics</a>
        </div>
        
        <div class="entry-tags">
          <a href="/tags/outbreaker2">outbreaker2</a>
        </div>
        
        <div class="entry-tags">
          <a href="/tags/reproduction-number">reproduction-number</a>
        </div>
        
        <div class="entry-tags">
          <a href="/tags/response">response</a>
        </div>
        
        <div class="entry-tags">
          <a href="/tags/rmarkdown">rmarkdown</a>
        </div>
        
        <div class="entry-tags">
          <a href="/tags/simulation">simulation</a>
        </div>
        
      </div>
    </div>
    <div class="col-md-10">
      <div class="entry-content">
        <script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<link href="/rmarkdown-libs/vis/vis.css" rel="stylesheet" />
<script src="/rmarkdown-libs/vis/vis.min.js"></script>
<script src="/rmarkdown-libs/visNetwork-binding/visNetwork.js"></script>
<link href="/rmarkdown-libs/font-awesome/css/font-awesome.min.css" rel="stylesheet" />


<p>This practical is the second part of the response to a simulated Ebola Virus Disease (EVD) outbreak taking place in the city of Ankh, Republic of Morporkia. While the <a href="../simulated-evd-early">first part</a> focussed on early assessments of transmissibility, this part explores more methodological options for estimating transmissibility, and provides an introduction to outbreak reconstruction using <em>outbreaker2</em>.</p>
<p><br></p>
<div id="an-update-on-the-evd-outbreak-in-ankh-republic-of-morporkia" class="section level1">
<h1>An update on the EVD outbreak in Ankh, Republic of Morporkia</h1>
<p>After some rather concerning <a href="../simulated-evd-early">preliminary results</a> on the new EVD outbreak in the city of Ankh, Republic of Morporkia, Public Health Morporkia (PHM) has sent you updates of the linelists and contact data. This time, PHM has also obtained Whole Genome Sequences (WGS) of the Ebola virus isolated in patients. As before, you are asked to assess the situation and produce evidence-based recommendations for informing the response.</p>
<div id="required-packages" class="section level2">
<h2>Required packages</h2>
<p>The following packages, available on CRAN, are needed for this practical:</p>
<ul>
<li><a href="http://www.repidemicsconsortium.org/incidence/"><code>xlsx</code></a> to read <code>.xlsx</code> files</li>
<li><a href="http://ggplot2.org/"><code>ggplot2</code></a> for graphics</li>
<li><a href="http://www.repidemicsconsortium.org/incidence/"><code>incidence</code></a> for epicurves</li>
<li><a href="http://www.repidemicsconsortium.org/epicontacts/"><code>epicontacts</code></a> for contact data visualisation</li>
<li><a href="https://cran.r-project.org/web/packages/EpiEstim/index.html"><code>EpiEstim</code></a> for time-varying reproduction number estimation</li>
<li><a href="http://www.repidemicsconsortium.org/distcrete"><code>distcrete</code></a> to obtain discrete time delay distributions</li>
<li><a href="http://ape-package.ird.fr/"><code>ape</code></a> for DNA sequence analysis</li>
</ul>
<p>To install these packages, use <code>install.packages</code>, e.g.:</p>
<pre class="r"><code>install.packages(&quot;xlsx&quot;)
install.packages(&quot;ggplot2&quot;)
install.packages(&quot;incidence&quot;)
install.packages(&quot;epicontacts&quot;)
install.packages(&quot;EpiEstim&quot;)
install.packages(&quot;distcrete&quot;)
install.packages(&quot;ape&quot;)
</code></pre>
<p>We will also use several packages currently under development, hosted on <em>github</em>. These include:</p>
<ul>
<li><a href="http://www.repidemicsconsortium.org/epitrix"><code>epitrix</code></a> for some practical tricks</li>
<li><a href="http://www.repidemicsconsortium.org/outbreaker2"><code>outbreaker2</code></a> to reconstruct the outbreak</li>
</ul>
<p>To install these, you will need a working version of <code>devtools</code>, and the toolchain for package building on your system. On windows, you will likely need to install <a href="https://cran.r-project.org/bin/windows/Rtools/"><em>Rtools</em></a>.</p>
<pre class="r"><code>devtools::install_github(&quot;reconhub/epitrix&quot;)
devtools::install_github(&quot;reconhub/outbreaker2&quot;)</code></pre>
</div>
<div id="the-new-data" class="section level2">
<h2>The new data</h2>
<p>The data update includes new linelists and contact lists:</p>
<ul>
<li><p><a href="../../data/PHM-EVD-linelist-2017-11-25.xlsx">PHM-EVD-linelist-2017-11-25.xlsx</a>: a linelist containing case information up to the 25th November 2017</p></li>
<li><p><a href="../../data/PHM-EVD-contacts-2017-11-25.xlsx">PHM-EVD-contacts-2017-11-25.xlsx</a>: a list of contacts reported between cases up to the 25th November, where <code>from</code> indicates a potential source of infection, and <code>to</code> the recipient of the contact.</p></li>
</ul>
<p>To read into R, download these files and use the function <code>read.xlsx()</code> from the <code>xlsx</code> package to import the data. Each import will create a <code>data.frame</code>. Call the first one <code>linelist</code>, and the second one <code>contacts</code>. For instance, your first command line could look like:</p>
<pre class="r"><code>linelist &lt;- xlsx::read.xlsx(&quot;PHM-EVD-linelist-2017-11-25.xlsx&quot;,
                            sheetIndex = 1, stringsAsFactors = FALSE)</code></pre>
<p>Once imported, the data should look like:</p>
<pre class="r"><code>
## linelist: one line per case
head(linelist)
##   case_id      onset    sex age
## 1  39e9dc 2017-10-10 female  62
## 2  664549 2017-10-16   male  28
## 3  b4d8aa 2017-10-17   male  54
## 4  51883d 2017-10-18   male  57
## 5  947e40 2017-10-20 female  23
## 6  9aa197 2017-10-20 female  66


## contacts: pairs of cases with reported contacts
head(contacts)
##     from     to
## 1 9aa197 426b6d
## 2 39e9dc a8e9d8
## 3 c2a389 95fc1d
## 4 51883d 778316
## 5 51883d e37897
## 6 933811 99abbe</code></pre>
</div>
</div>
<div id="analysis-of-epidemiological-data" class="section level1">
<h1>Analysis of epidemiological data</h1>
<div id="visualising-contact-data" class="section level2">
<h2>Visualising contact data</h2>
<p>After the initial stage of the outbreak, contact tracing has been maintained but started being sparser, and exposures haven’t been reported for all cases. Despite these limitations, contacts are still a valuable source of information. Using the function <code>make_epicontacts</code> in the <code>epicontacts</code> package, create a new <code>epicontacts</code> object called <code>x</code>, specifying that contacts are directed. When plotting the data, use the arguments <code>node_shape</code> and <code>shapes</code> (see <code>?vis_epicontacts</code>) to distinguish males and females. For a list of available symbols and corresponding shape code, you can type <code>epicontacts::codeawesome</code>.</p>
<p>The results should look like:</p>
<pre><code>## 
## /// Epidemiological Contacts //
## 
##   // class: epicontacts
##   // 50 cases in linelist; 36 contacts;  directed 
## 
##   // linelist
## 
## # A tibble: 50 x 4
##        id      onset    sex   age
##  *  &lt;chr&gt;     &lt;date&gt;  &lt;chr&gt; &lt;dbl&gt;
##  1 39e9dc 2017-10-10 female    62
##  2 664549 2017-10-16   male    28
##  3 b4d8aa 2017-10-17   male    54
##  4 51883d 2017-10-18   male    57
##  5 947e40 2017-10-20 female    23
##  6 9aa197 2017-10-20 female    66
##  7 e4b0a2 2017-10-21 female    13
##  8 af0ac0 2017-10-21   male    10
##  9 185911 2017-10-21 female    34
## 10 601d2e 2017-10-22   male    11
## # ... with 40 more rows
## 
##   // contacts
## 
## # A tibble: 36 x 2
##      from     to
##     &lt;chr&gt;  &lt;chr&gt;
##  1 9aa197 426b6d
##  2 39e9dc a8e9d8
##  3 c2a389 95fc1d
##  4 51883d 778316
##  5 51883d e37897
##  6 933811 99abbe
##  7 51883d 185911
##  8 b4d8aa e4b0a2
##  9 605322 1875e2
## 10 b4d8aa b5ad13
## # ... with 26 more rows</code></pre>
<div id="htmlwidget-1" style="width:90%;height:700px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"nodes":{"id":["185911","1875e2","1b035f","1efd54","39e9dc","3a5305","426b6d","4945f2","501b8f","51883d","55a452","59e66c","5eb2b0","601d2e","605322","6f3c15","778316","88526e","8bed66","8c5776","933811","93a3ba","947e40","95fc1d","99141e","99abbe","9aa197","a402f6","a8e9d8","ac8d9d","ae87f7","af0ac0","b4d8aa","b5ad13","bcfad3","c2a389","d5564e","e37897","e399b1","e4b0a2","f658bc"],"onset":["2017-10-21","2017-11-16","2017-11-04","2017-11-04","2017-10-10","2017-11-13","2017-11-08","2017-11-16","2017-11-05","2017-10-18","2017-11-14","2017-11-16","2017-11-13","2017-10-22","2017-10-22","2017-10-29","2017-11-04","2017-11-03","2017-11-08","2017-11-02","2017-11-16","2017-11-10","2017-10-20","2017-11-19","2017-11-12","2017-11-18","2017-10-20","2017-11-09","2017-10-29","2017-11-23","2017-11-01","2017-10-21","2017-10-17","2017-11-07","2017-11-18","2017-11-10","2017-11-20","2017-10-28","2017-10-23","2017-10-21","2017-10-28"],"sex":["female","male","male","male","female","male","female","male","male","male","female","male","female","male","female","male","female","female","female","female","male","male","female","female","male","male","female","male","female","female","male","male","male","female","female","female","female","female","female","female","male"],"age":[34,30,29,8,62,29,7,19,23,57,33,9,7,11,23,13,10,20,29,7,16,7,23,15,15,14,66,26,37,5,25,10,54,21,31,26,43,9,23,13,68],"label":["185911","1875e2","1b035f","1efd54","39e9dc","3a5305","426b6d","4945f2","501b8f","51883d","55a452","59e66c","5eb2b0","601d2e","605322","6f3c15","778316","88526e","8bed66","8c5776","933811","93a3ba","947e40","95fc1d","99141e","99abbe","9aa197","a402f6","a8e9d8","ac8d9d","ae87f7","af0ac0","b4d8aa","b5ad13","bcfad3","c2a389","d5564e","e37897","e399b1","e4b0a2","f658bc"],"title":["<p> id: 185911<br>onset: 2017-10-21<br>sex: female<br>age: 34 <\/p>","<p> id: 1875e2<br>onset: 2017-11-16<br>sex: male<br>age: 30 <\/p>","<p> id: 1b035f<br>onset: 2017-11-04<br>sex: male<br>age: 29 <\/p>","<p> id: 1efd54<br>onset: 2017-11-04<br>sex: male<br>age: 8 <\/p>","<p> id: 39e9dc<br>onset: 2017-10-10<br>sex: female<br>age: 62 <\/p>","<p> id: 3a5305<br>onset: 2017-11-13<br>sex: male<br>age: 29 <\/p>","<p> id: 426b6d<br>onset: 2017-11-08<br>sex: female<br>age: 7 <\/p>","<p> id: 4945f2<br>onset: 2017-11-16<br>sex: male<br>age: 19 <\/p>","<p> id: 501b8f<br>onset: 2017-11-05<br>sex: male<br>age: 23 <\/p>","<p> id: 51883d<br>onset: 2017-10-18<br>sex: male<br>age: 57 <\/p>","<p> id: 55a452<br>onset: 2017-11-14<br>sex: female<br>age: 33 <\/p>","<p> id: 59e66c<br>onset: 2017-11-16<br>sex: male<br>age: 9 <\/p>","<p> id: 5eb2b0<br>onset: 2017-11-13<br>sex: female<br>age: 7 <\/p>","<p> id: 601d2e<br>onset: 2017-10-22<br>sex: male<br>age: 11 <\/p>","<p> id: 605322<br>onset: 2017-10-22<br>sex: female<br>age: 23 <\/p>","<p> id: 6f3c15<br>onset: 2017-10-29<br>sex: male<br>age: 13 <\/p>","<p> id: 778316<br>onset: 2017-11-04<br>sex: female<br>age: 10 <\/p>","<p> id: 88526e<br>onset: 2017-11-03<br>sex: female<br>age: 20 <\/p>","<p> id: 8bed66<br>onset: 2017-11-08<br>sex: female<br>age: 29 <\/p>","<p> id: 8c5776<br>onset: 2017-11-02<br>sex: female<br>age: 7 <\/p>","<p> id: 933811<br>onset: 2017-11-16<br>sex: male<br>age: 16 <\/p>","<p> id: 93a3ba<br>onset: 2017-11-10<br>sex: male<br>age: 7 <\/p>","<p> id: 947e40<br>onset: 2017-10-20<br>sex: female<br>age: 23 <\/p>","<p> id: 95fc1d<br>onset: 2017-11-19<br>sex: female<br>age: 15 <\/p>","<p> id: 99141e<br>onset: 2017-11-12<br>sex: male<br>age: 15 <\/p>","<p> id: 99abbe<br>onset: 2017-11-18<br>sex: male<br>age: 14 <\/p>","<p> id: 9aa197<br>onset: 2017-10-20<br>sex: female<br>age: 66 <\/p>","<p> id: a402f6<br>onset: 2017-11-09<br>sex: male<br>age: 26 <\/p>","<p> id: a8e9d8<br>onset: 2017-10-29<br>sex: female<br>age: 37 <\/p>","<p> id: ac8d9d<br>onset: 2017-11-23<br>sex: female<br>age: 5 <\/p>","<p> id: ae87f7<br>onset: 2017-11-01<br>sex: male<br>age: 25 <\/p>","<p> id: af0ac0<br>onset: 2017-10-21<br>sex: male<br>age: 10 <\/p>","<p> id: b4d8aa<br>onset: 2017-10-17<br>sex: male<br>age: 54 <\/p>","<p> id: b5ad13<br>onset: 2017-11-07<br>sex: female<br>age: 21 <\/p>","<p> id: bcfad3<br>onset: 2017-11-18<br>sex: female<br>age: 31 <\/p>","<p> id: c2a389<br>onset: 2017-11-10<br>sex: female<br>age: 26 <\/p>","<p> id: d5564e<br>onset: 2017-11-20<br>sex: female<br>age: 43 <\/p>","<p> id: e37897<br>onset: 2017-10-28<br>sex: female<br>age: 9 <\/p>","<p> id: e399b1<br>onset: 2017-10-23<br>sex: female<br>age: 23 <\/p>","<p> id: e4b0a2<br>onset: 2017-10-21<br>sex: female<br>age: 13 <\/p>","<p> id: f658bc<br>onset: 2017-10-28<br>sex: male<br>age: 68 <\/p>"],"icon.color":["#CCDDFF","#B9DAEA","#A6D8D6","#93D5C2","#81D3AE","#89CEA7","#A7C7AA","#C6C0AD","#E4B9B0","#FCB2B3","#E8AFB6","#D3ABB9","#BFA8BC","#AAA5BF","#B1AAA4","#C6B378","#DABC4D","#EFC521","#FFC906","#FFBF23","#FFB540","#FFAB5C","#FFA179","#F6AF84","#EAC58A","#DFDB8F","#D3F095","#CDF79B","#D1E2A4","#D5CCAC","#DAB6B5","#DEA1BE","#E5A8B7","#ECB2AE","#F3BCA6","#FBC69D","#F9CC9E","#EECCA9","#E3CCB5","#D8CCC1","#CDCDCD"],"group.color":["#CCDDFF","#B9DAEA","#A6D8D6","#93D5C2","#81D3AE","#89CEA7","#A7C7AA","#C6C0AD","#E4B9B0","#FCB2B3","#E8AFB6","#D3ABB9","#BFA8BC","#AAA5BF","#B1AAA4","#C6B378","#DABC4D","#EFC521","#FFC906","#FFBF23","#FFB540","#FFAB5C","#FFA179","#F6AF84","#EAC58A","#DFDB8F","#D3F095","#CDF79B","#D1E2A4","#D5CCAC","#DAB6B5","#DEA1BE","#E5A8B7","#ECB2AE","#F3BCA6","#FBC69D","#F9CC9E","#EECCA9","#E3CCB5","#D8CCC1","#CDCDCD"],"shape":["icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon"],"icon.code":["f182","f183","f183","f183","f182","f183","f182","f183","f183","f183","f182","f183","f182","f183","f182","f183","f182","f182","f182","f182","f183","f183","f182","f182","f183","f183","f182","f183","f182","f182","f183","f183","f183","f182","f182","f182","f182","f182","f182","f182","f183"]},"edges":{"from":["9aa197","39e9dc","c2a389","51883d","51883d","933811","51883d","b4d8aa","605322","b4d8aa","b4d8aa","f658bc","51883d","1b035f","c2a389","9aa197","51883d","778316","9aa197","b4d8aa","39e9dc","5eb2b0","39e9dc","88526e","39e9dc","9aa197","b4d8aa","778316","39e9dc","9aa197","1efd54","f658bc","b4d8aa","c2a389","39e9dc","a8e9d8"],"to":["426b6d","a8e9d8","95fc1d","778316","e37897","99abbe","185911","e4b0a2","1875e2","b5ad13","55a452","ae87f7","6f3c15","8bed66","99141e","d5564e","501b8f","93a3ba","88526e","3a5305","b4d8aa","4945f2","601d2e","5eb2b0","e399b1","f658bc","af0ac0","a402f6","947e40","8c5776","59e66c","1b035f","bcfad3","ac8d9d","605322","933811"],"width":[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],"arrows":["to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false},"physics":{"stabilization":false}},"groups":["#CCDDFF","#B9DAEA","#A6D8D6","#93D5C2","#81D3AE","#89CEA7","#A7C7AA","#C6C0AD","#E4B9B0","#FCB2B3","#E8AFB6","#D3ABB9","#BFA8BC","#AAA5BF","#B1AAA4","#C6B378","#DABC4D","#EFC521","#FFC906","#FFBF23","#FFB540","#FFAB5C","#FFA179","#F6AF84","#EAC58A","#DFDB8F","#D3F095","#CDF79B","#D1E2A4","#D5CCAC","#DAB6B5","#DEA1BE","#E5A8B7","#ECB2AE","#F3BCA6","#FBC69D","#F9CC9E","#EECCA9","#E3CCB5","#D8CCC1","#CDCDCD"],"width":"90%","height":"700px","idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)"},"main":null,"submain":null,"footer":null,"legend":{"width":0.2,"useGroups":false,"position":"left","ncol":1,"stepX":100,"stepY":100},"highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null},"iconsRedraw":true},"evals":[],"jsHooks":[]}</script>
<p><font class="question">What can you say about these contacts? How would you interpret the different clusters?</font></p>
</div>
<div id="building-epicurves" class="section level2">
<h2>Building epicurves</h2>
<p>Using the same approach as in the <a href="../simulated-evd-early">first part</a> of the practical, use <code>incidence</code> (from the <code>incidence</code> package) to compute and plot epicurves using dates of symptom onset. As the time series is now longer, compare daily incidence to weekly incidence.</p>
<p>You should obtain something like:</p>
<p><img src="/post/2017-11-22-sim-ebola-reconstruction_files/figure-html/incidence-1.png" width="672" /><img src="/post/2017-11-22-sim-ebola-reconstruction_files/figure-html/incidence-2.png" width="672" /></p>
<p>As there are no longer time intervals with ‘zero’ incidence on the weekly epicurve, which are problematic for log-linear regression, we can try fitting a model to these data; we do so here, with <code>i</code> being the weekly incidence:</p>
<pre class="r"><code>f &lt;- fit(i)
f
## &lt;incidence_fit object&gt;
## 
## $lm: regression of log-incidence over time
## 
## $info: list containing the following items:
##   $r (daily growth rate):
## [1] 0.02689489
## 
##   $r.conf (confidence interval):
##            2.5 %     97.5 %
## [1,] -0.03115559 0.08494537
## 
##   $doubling (doubling time in days):
## [1] 25.77245
## 
##   $doubling.conf (confidence interval):
##         2.5 %    97.5 %
## [1,] 8.159917 -22.24792
## 
##   $pred: data.frame of incidence predictions (7 rows, 5 columns)
plot(i, color = &quot;#c65353&quot;, fit = f)</code></pre>
<p><img src="/post/2017-11-22-sim-ebola-reconstruction_files/figure-html/fit-1.png" width="672" /></p>
<p>How would you interpret this result? What are the limitations of this analysis?</p>
</div>
<div id="estimating-transmissibility" class="section level2">
<h2>Estimating transmissibility</h2>
<p>Repeating the same analysis as in the <a href="../simulated-evd-early">early stage</a> of the outbreak, we can use <code>get_R</code> from the <code>earlyR</code> package to estimate the reproduction number:</p>
<pre class="r"><code>library(earlyR)

## parameters of the serial interval
mu &lt;- 15.3
sd &lt;- 9.3

daily_i &lt;- incidence(linelist$onset)
simple_R &lt;- get_R(daily_i, si_mean = mu, si_sd =  9.3)
simple_R
## 
## /// Early estimate of reproduction number (R) //
##  // class: earlyR, list
## 
##  // Maximum-Likelihood estimate of R ($R_ml):
## [1] 1.481481
## 
## 
##  // $lambda:
##   0.01838179 0.0273192 0.03514719 0.0414835 0.04623398 0.04946402...
## 
##  // $dates:
## [1] &quot;2017-10-11&quot; &quot;2017-10-12&quot; &quot;2017-10-13&quot; &quot;2017-10-14&quot; &quot;2017-10-15&quot;
## [6] &quot;2017-10-16&quot;
## ...
## 
##  // $si (serial interval):
## A discrete distribution
##   name: gamma
##   parameters:
##     shape: 2.70655567117586
##     scale: 5.65294117647059

## R: likelihood function
plot(simple_R)</code></pre>
<p><img src="/post/2017-11-22-sim-ebola-reconstruction_files/figure-html/basic_R-1.png" width="672" /></p>
<pre class="r"><code>
## force of infection
plot(simple_R, &quot;lambdas&quot;)
abline(v = as.Date(&quot;2017-11-25&quot;))</code></pre>
<p><img src="/post/2017-11-22-sim-ebola-reconstruction_files/figure-html/basic_R-2.png" width="672" /></p>
<p>What do you make of these results? What is the main limitation of the estimation of the reproduction number (<span class="math inline">\(R\)</span>) in this analysis? What assumption does it make about the outbreak?</p>
</div>
<div id="estimating-time-varying-transmissibility" class="section level2">
<h2>Estimating time-varying transmissibility</h2>
<p>When the assumption that <span class="math inline">\(R\)</span> is constant over time becomes untenable, an alternative is the estimationg of time-varying transmissibility using the instantaneous reproduction number <span class="math inline">\(R_t\)</span>. This approach, introduced by Cori et al. <span class="citation">(2013)</span>, is implemented in the package <code>EpiEstim</code> (function <code>EstimateR</code>). It esimates <span class="math inline">\(R_t\)</span> for a succession of sliding time windows, using the same Poisson likelihood described in the <a href="../simulated-evd-early">first part</a>. In the following, we use <code>EstimateR</code> to estimate transmissibility for 1-week sliding time windows:</p>
<pre class="r"><code>library(EpiEstim)
library(ggplot2)

days &lt;- seq_along(daily_i$dates)
Rt &lt;- EstimateR(as.vector(daily_i$counts), days, days + 7, method = &quot;ParametricSI&quot;,
                   Mean.SI = mu, Std.SI = sd)
## Warning in EstimateR(as.vector(daily_i$counts), days, days + 7, method =
## &quot;ParametricSI&quot;, : You&#39;re estimating R too early in the epidemic to get the
## desired posterior CV.
Rt &lt;- Rt$R[days,]
head(Rt, 10)
##    T.Start T.End  Mean(R)   Std(R) Quantile.0.025(R) Quantile.0.05(R)
## 1        1     8       NA       NA                NA               NA
## 2        2     9       NA       NA                NA               NA
## 3        3    10       NA       NA                NA               NA
## 4        4    11       NA       NA                NA               NA
## 5        5    12       NA       NA                NA               NA
## 6        6    13       NA       NA                NA               NA
## 7        7    14       NA       NA                NA               NA
## 8        8    15 7.555653 2.278115          3.771755         4.237352
## 9        9    16 5.465582 1.728369          2.620959         2.965300
## 10      10    17 3.983330 1.327777          1.821432         2.078071
##    Quantile.0.25(R) Median(R) Quantile.0.75(R) Quantile.0.95(R)
## 1                NA        NA               NA               NA
## 2                NA        NA               NA               NA
## 3                NA        NA               NA               NA
## 4                NA        NA               NA               NA
## 5                NA        NA               NA               NA
## 6                NA        NA               NA               NA
## 7                NA        NA               NA               NA
## 8          5.920753  7.327968         8.942893        11.650967
## 9          4.222647  5.284515         6.511610         8.583814
## 10         3.026288  3.836810         4.781078         6.388663
##    Quantile.0.975(R)
## 1                 NA
## 2                 NA
## 3                 NA
## 4                 NA
## 5                 NA
## 6                 NA
## 7                 NA
## 8          12.631922
## 9           9.337839
## 10          6.976664</code></pre>
<p><code>EpiEstim</code> is not yet integrated with other RECON packages, so adding the results to existing <code>incidence</code> plots takes some customisation using <code>ggplot2</code>. Uses the following commands to add estimates of <span class="math inline">\(R_r\)</span> to the daily incidence:</p>
<pre class="r"><code>
names(Rt) &lt;- gsub(&quot;[(]R[)]&quot;, &quot;&quot;, names(Rt))
Rt &lt;- cbind.data.frame(as.data.frame(daily_i),
                       Rt)
plot(daily_i) +
    geom_ribbon(data = Rt, fill = &quot;#c65353&quot;, alpha = .3,
                aes(ymin = Quantile.0.025, ymax = Quantile.0.975)) +
    geom_line(data = Rt, aes(y = Median), col = &quot;#c65353&quot;, alpha = .8) +
    geom_hline(yintercept = 1, linetype = 2) +
    labs(title = &quot;Weekly Rt: median, and 95% CI&quot;)
## Warning: Removed 14 rows containing missing values (geom_path).</code></pre>
<p><img src="/post/2017-11-22-sim-ebola-reconstruction_files/figure-html/epiestimplot-1.png" width="672" /></p>
<p><font class="question">How would you interpret this result? What is the caveat of this representation?</font></p>
</div>
</div>
<div id="finding-who-infected-whom" class="section level1">
<h1>Finding who infected whom</h1>
<p>To gain a better understanding of the transmission process, we can attempt to reconstruct plausible transmission trees using the dates of symptom onsets and limited contact data. This can be achieved using <code>outbreaker2</code>, which provides a modular platform for outbreak reconstruction. This package extends and replaces <code>outbreaker</code>, which in contrast was a static implementation of a specific transmission model <span class="citation">(Jombart et al. 2014)</span>.</p>
<div id="building-delay-distributions" class="section level2">
<h2>Building delay distributions</h2>
<p><code>outbreaker2</code> can handle different types of dates. When dates of onset are provided, information on the generation time (delay between primary and secondary infections) and on the incubation period (delay between infection and symptom onset) can be included in the model. These distributions are typically modelled as Gamma distributions, which need to be discretised in order to account for the fact that time is reported as days.</p>
<p>In the following, we show how the generation time distribution can be constructed from known parameters, which are here taken from the serial interval, with a mean of 15.3 and a standard deviation of 9.3. We use <code>epitrix</code> to convert these parameters into <em>shape</em> and <em>scale</em> for a Gamma distribution, and then use <code>distcrete</code> to generate the discretised distribution:</p>
<pre class="r"><code>library(epitrix)
library(distcrete)

mu &lt;- 15.3
sd &lt;- 9.3
gt_params &lt;- epitrix::gamma_mucv2shapescale(mu, sd / mu)
gt_params
## $shape
## [1] 2.706556
## 
## $scale
## [1] 5.652941
gt &lt;- distcrete(&quot;gamma&quot;, shape = gt_params$shape, scale = gt_params$scale,
                interval = 1L, w = 0)
gt
## A discrete distribution
##   name: gamma
##   parameters:
##     shape: 2.70655567117586
##     scale: 5.65294117647059
plot(gt$d, type = &quot;h&quot;, xlim = c(0,50), col = &quot;navy&quot;, lwd = 2,
     xlab = &quot;Days after symptoms&quot;, ylab = &quot;Probability&quot;,
     main = &quot;Generation time distribution&quot;)</code></pre>
<p><img src="/post/2017-11-22-sim-ebola-reconstruction_files/figure-html/si-1.png" width="672" /></p>
<p>Using the same process, create a distribution for the incubation period, which has been reported to have a mean of 9.1 with a standard deviation of 7.3 <span class="citation">(WHO Ebola Response Team 2014)</span>. Call this object <code>incub</code>, and plot the distribution, which should look like this:</p>
<pre><code>## $shape
## [1] 1.55395
## 
## $scale
## [1] 5.856044
## A discrete distribution
##   name: gamma
##   parameters:
##     shape: 1.55395008444361
##     scale: 5.85604395604396</code></pre>
<p><img src="/post/2017-11-22-sim-ebola-reconstruction_files/figure-html/incub-1.png" width="672" /></p>
</div>
<div id="looking-at-whole-genome-sequences-wgs" class="section level2">
<h2>Looking at Whole Genome Sequences (WGS)</h2>
<p>WGS have been obtained for all cases in this outbreak. They are stored as a <code>fasta</code> <a href="../../static/data/PHM-EVD-WGS.fa">PHM-EVD-WGS.fa</a>. Download this file, save it in your working directory, and then import these data using the function <code>read.FASTA</code> from the <code>ape</code> package.</p>
<pre class="r"><code>library(ape)
## dna &lt;- read.FASTA(&quot;PHM-EVD-WGS.fa&quot;)
dna
## 50 DNA sequences in binary format stored in a list.
## 
## All sequences of same length: 18958 
## 
## Labels:
## 39e9dc
## 664549
## b4d8aa
## 51883d
## 947e40
## 9aa197
## ...
## 
## Base composition:
##     a     c     g     t 
## 0.250 0.248 0.248 0.254
identical(labels(dna), linelist$case_id) # check sequences match linelist data
## [1] TRUE</code></pre>
<p>As a first exploration of the data, we derive a Neighbour-Joining tree rooted at the first case of the outbreak:</p>
<pre class="r"><code>nj &lt;- nj(dist.dna(dna, model = &quot;N&quot;)) # NJ on nucleotide distances (model = &quot;N&quot;)
nj
## 
## Phylogenetic tree with 50 tips and 48 internal nodes.
## 
## Tip labels:
##  39e9dc, 664549, b4d8aa, 51883d, 947e40, 9aa197, ...
## 
## Unrooted; includes branch lengths.
nj &lt;- root(nj, 1)
plot(nj)
axisPhylo()</code></pre>
<p><img src="/post/2017-11-22-sim-ebola-reconstruction_files/figure-html/nj-1.png" width="672" /></p>
<p><font class="question">How would you interpret this phylogenetic tree? Many methods of outbreak reconstruction infer transmission events from phylogenies. What results would you expect here?</font></p>
</div>
<div id="using-the-original-outbreaker-model" class="section level2">
<h2>Using the original <code>outbreaker</code> model</h2>
<p>The original <code>outbreaker</code> model combined temporal information (here, dates of onset) with sequence data to infer who infected whom. Here, we use <code>outbreaker2</code> to apply this model to the data.</p>
<p>All inputs to the new <code>outbreaker</code> function are prepared using dedicated functions, which make a number of checks on provided inputs and define defaults:</p>
<pre class="r"><code>library(outbreaker2)
## 
## Attaching package: &#39;outbreaker2&#39;
## The following object is masked from &#39;package:epicontacts&#39;:
## 
##     cases_pal

data &lt;- outbreaker_data(dates = linelist$onset, # dates of onset
                        dna = unname(dna), # WGS; remove labels for compatibility
                        w_dens = gt$d(1:100), # generation time distribution
                        f_dens = incub$d(1:100) # incubation period distribution
                        )</code></pre>
<p>We also create a configuration, which determines different aspects of the analysis, including which parameters need to be estimated, initial values of parameters, the length of the MCMC, etc.:</p>
<pre class="r"><code>config &lt;- create_config(move_kappa = FALSE, # don&#39;t look for missing cases
                        move_pi = FALSE, # don&#39;t estimate reporting
                        init_pi = 1, # set reporting to 1
                        find_import = FALSE, # don&#39;t look for additional imported cases
                        init_tree = &quot;star&quot; # star-like tree as starting point
                        )</code></pre>
<p>We can now run the analysis. This should take a couple of minutes on modern laptops. Note the use of <code>set.seed(0)</code> to have identical results across different users and computers:</p>
<pre class="r"><code>set.seed(0)
res_basic &lt;- outbreaker(data = data, config = config)
res_basic
## 
## 
##  ///// outbreaker results ///
## 
## class:  outbreaker_chains data.frame
## dimensions 201 rows,  158 columns
## ancestries not shown: alpha_1 - alpha_50
## infection dates not shown: t_inf_1 - t_inf_50
## intermediate generations not shown: kappa_1 - kappa_50
## 
## /// head //
##   step       post       like    prior           mu pi eps lambda
## 1    1 -1936.3806 -1938.6830 2.302485 1.000000e-04  1 0.5   0.05
## 2   50  -815.9694  -818.2719 2.302535 4.991125e-05  1 0.5   0.05
## 3  100  -810.1838  -812.4863 2.302525 6.004337e-05  1 0.5   0.05
## 
## ...
## /// tail //
##      step      post      like    prior           mu pi eps lambda
## 199  9900 -804.9558 -807.2584 2.302531 5.450377e-05  1 0.5   0.05
## 200  9950 -816.4254 -818.7279 2.302527 5.847629e-05  1 0.5   0.05
## 201 10000 -822.2301 -824.5326 2.302534 5.119241e-05  1 0.5   0.05
plot(res_basic)</code></pre>
<p><img src="/post/2017-11-22-sim-ebola-reconstruction_files/figure-html/outbreaker-basic-1.png" width="672" /></p>
<pre class="r"><code>plot(res_basic, burn = 500)</code></pre>
<p><img src="/post/2017-11-22-sim-ebola-reconstruction_files/figure-html/outbreaker-basic-2.png" width="672" /></p>
<p>The first two plots show the trace of the log-posterior densities (with, and without burnin). See <code>?plot.outbreaker_chains</code> for details on available plots. Graphics worth looking at include:</p>
<pre class="r"><code>plot(res_basic,  type = &quot;alpha&quot;, burnin = 500) # ancestries</code></pre>
<p><img src="/post/2017-11-22-sim-ebola-reconstruction_files/figure-html/basic_plots-1.png" width="672" /></p>
<pre class="r"><code>plot(res_basic,  type = &quot;t_inf&quot;, burnin = 500) # infection dates</code></pre>
<p><img src="/post/2017-11-22-sim-ebola-reconstruction_files/figure-html/basic_plots-2.png" width="672" /></p>
<pre class="r"><code>plot(res_basic, &quot;mu&quot;, burn = 500, type = &quot;density&quot;) # mutation rate</code></pre>
<p><img src="/post/2017-11-22-sim-ebola-reconstruction_files/figure-html/basic_plots-3.png" width="672" /></p>
<pre class="r"><code>plot(res_basic,  type = &quot;network&quot;, burnin = 500, min_support = .05) # transmission trees</code></pre>
<div id="htmlwidget-2" style="width:672px;height:480px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-2">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50],"label":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50],"value":[3.34210526315789,0,3.71052631578947,1.95263157894737,1.81052631578947,3.46315789473684,0,3.28947368421053,1.95789473684211,2.84736842105263,0.921052631578947,0,1.51052631578947,2.18947368421053,1.38947368421053,0,0,1.68947368421053,0,1,1.28421052631579,1.92631578947368,1.14210526315789,0,0,0,1.8,0.436842105263158,1.43684210526316,0.768421052631579,0,0.973684210526316,0.563157894736842,1.11578947368421,0.415789473684211,0,0,0,0.0789473684210526,0.805263157894737,0.610526315789474,0,0,0.58421052631579,0.810526315789474,0.747368421052632,0.884210526315789,1.03157894736842,0.510526315789474,0],"color":["#CCDDFF","#BCDAEE","#ADD8DE","#9ED6CD","#8FD4BD","#7FD2AD","#86CEA7","#9FC9A9","#B7C3AC","#D0BDAE","#E9B8B0","#FDB2B3","#ECAFB5","#DBADB8","#CBAABB","#BAA7BD","#A9A4C0","#AFA8A9","#BFB085","#D0B762","#E1BE3F","#F2C61B","#FFCA05","#FFC11C","#FFB934","#FFB14B","#FFA963","#FFA07A","#F7AC83","#EEBE88","#E4CF8C","#DBE191","#D2F395","#CDF99B","#D0E7A2","#D4D5A9","#D7C4B0","#DBB2B7","#DEA0BE","#E4A6B8","#EAAEB1","#EFB6AA","#F5BFA3","#FBC79C","#FACC9D","#F1CCA6","#E8CCB0","#DFCCB9","#D6CCC3","#CDCDCD"],"shape":["dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot"],"shaped":["star",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]},"edges":{"from":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,3,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,11,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,14,15,15,18,18,18,18,18,18,18,18,18,18,18,18,18,18,18,20,20,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,27,28,29,29,29,29,29,29,29,29,30,30,30,32,32,32,33,34,34,35,39,40,40,40,40,40,40,40,41,41,44,45,45,45,45,45,45,45,46,46,46,47,47,48,48,48,48,48,48,49,49,49],"to":[2,3,4,5,8,9,10,11,12,13,15,23,29,39,7,8,26,30,32,35,36,42,44,46,49,6,9,13,16,23,24,29,31,1,2,3,8,9,10,11,12,15,14,17,18,19,20,21,22,25,27,28,33,37,40,45,48,50,3,7,26,30,32,35,36,42,44,46,4,6,13,16,23,24,29,31,1,2,3,4,5,8,9,11,12,13,15,41,39,4,6,9,16,23,24,29,31,6,17,18,19,20,21,22,25,27,28,33,37,40,45,48,50,41,43,6,14,17,19,20,22,25,27,28,33,37,40,45,48,50,34,47,14,18,19,20,25,27,28,37,40,45,48,50,6,14,17,18,19,20,21,25,27,28,33,37,40,45,48,50,4,6,9,13,16,24,29,31,6,14,17,18,19,20,21,22,25,28,33,37,40,45,48,50,33,4,6,9,13,16,23,24,31,32,46,49,30,46,49,28,38,47,44,11,18,21,22,27,37,48,50,15,43,35,18,19,22,27,37,40,50,30,32,49,34,38,25,27,37,40,45,50,30,32,46],"value":[0.473684210526316,0.336842105263158,0.115789473684211,0.347368421052632,0.173684210526316,0.184210526315789,0.58421052631579,0.310526315789474,0.289473684210526,0.131578947368421,0.2,0.068421052631579,0.0578947368421053,0.0526315789473684,0.673684210526316,0.605263157894737,0.431578947368421,0.0789473684210526,0.236842105263158,0.210526315789474,0.442105263157895,0.510526315789474,0.310526315789474,0.142105263157895,0.068421052631579,0.221052631578947,0.184210526315789,0.263157894736842,0.263157894736842,0.205263157894737,0.226315789473684,0.284210526315789,0.194736842105263,0.142105263157895,0.173684210526316,0.0894736842105263,0.0631578947368421,0.0789473684210526,0.168421052631579,0.252631578947368,0.326315789473684,0.405263157894737,0.342105263157895,0.257894736842105,0.378947368421053,0.252631578947368,0.284210526315789,0.268421052631579,0.373684210526316,0.163157894736842,0.373684210526316,0.0578947368421053,0.1,0.0578947368421053,0.173684210526316,0.115789473684211,0.184210526315789,0.0789473684210526,0.394736842105263,0.326315789473684,0.568421052631579,0.0736842105263158,0.2,0.205263157894737,0.557894736842105,0.489473684210526,0.273684210526316,0.157894736842105,0.336842105263158,0.173684210526316,0.147368421052632,0.242105263157895,0.252631578947368,0.236842105263158,0.310526315789474,0.126315789473684,0.242105263157895,0.352631578947368,0.178947368421053,0.0631578947368421,0.515789473684211,0.157894736842105,0.1,0.357894736842105,0.384210526315789,0.0578947368421053,0.289473684210526,0.0789473684210526,0.921052631578947,0.210526315789474,0.1,0.210526315789474,0.184210526315789,0.131578947368421,0.205263157894737,0.205263157894737,0.205263157894737,0.0736842105263158,0.205263157894737,0.0947368421052632,0.147368421052632,0.152631578947368,0.1,0.126315789473684,0.236842105263158,0.115789473684211,0.0842105263157895,0.136842105263158,0.142105263157895,0.157894736842105,0.147368421052632,0.168421052631579,0.1,0.894736842105263,0.494736842105263,0.068421052631579,0.115789473684211,0.147368421052632,0.115789473684211,0.131578947368421,0.0842105263157895,0.131578947368421,0.0736842105263158,0.0578947368421053,0.0578947368421053,0.147368421052632,0.194736842105263,0.126315789473684,0.136842105263158,0.0578947368421053,0.521052631578947,0.478947368421053,0.068421052631579,0.0736842105263158,0.068421052631579,0.105263157894737,0.105263157894737,0.0578947368421053,0.0526315789473684,0.142105263157895,0.0894736842105263,0.0947368421052632,0.110526315789474,0.184210526315789,0.0526315789473684,0.136842105263158,0.121052631578947,0.110526315789474,0.168421052631579,0.115789473684211,0.278947368421053,0.131578947368421,0.0947368421052632,0.0526315789473684,0.0578947368421053,0.152631578947368,0.0894736842105263,0.115789473684211,0.152631578947368,0.0947368421052632,0.121052631578947,0.0578947368421053,0.115789473684211,0.142105263157895,0.152631578947368,0.152631578947368,0.0894736842105263,0.278947368421053,0.0842105263157895,0.131578947368421,0.142105263157895,0.121052631578947,0.131578947368421,0.1,0.115789473684211,0.168421052631579,0.110526315789474,0.0526315789473684,0.0842105263157895,0.0894736842105263,0.0578947368421053,0.1,0.136842105263158,0.173684210526316,0.436842105263158,0.121052631578947,0.0842105263157895,0.126315789473684,0.236842105263158,0.157894736842105,0.305263157894737,0.178947368421053,0.194736842105263,0.136842105263158,0.242105263157895,0.389473684210526,0.4,0.205263157894737,0.368421052631579,0.563157894736842,0.594736842105263,0.521052631578947,0.415789473684211,0.0789473684210526,0.0631578947368421,0.0578947368421053,0.0578947368421053,0.0631578947368421,0.0736842105263158,0.0842105263157895,0.0894736842105263,0.105263157894737,0.505263157894737,0.58421052631579,0.0526315789473684,0.0578947368421053,0.068421052631579,0.0842105263157895,0.0947368421052632,0.068421052631579,0.136842105263158,0.3,0.315789473684211,0.131578947368421,0.478947368421053,0.405263157894737,0.0578947368421053,0.0526315789473684,0.1,0.152631578947368,0.231578947368421,0.0842105263157895,0.147368421052632,0.110526315789474,0.252631578947368],"arrows":["to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to"],"color":["#CCDDFF","#CCDDFF","#CCDDFF","#CCDDFF","#CCDDFF","#CCDDFF","#CCDDFF","#CCDDFF","#CCDDFF","#CCDDFF","#CCDDFF","#CCDDFF","#CCDDFF","#CCDDFF","#ADD8DE","#ADD8DE","#ADD8DE","#ADD8DE","#ADD8DE","#ADD8DE","#ADD8DE","#ADD8DE","#ADD8DE","#ADD8DE","#ADD8DE","#9ED6CD","#9ED6CD","#9ED6CD","#9ED6CD","#9ED6CD","#9ED6CD","#9ED6CD","#9ED6CD","#8FD4BD","#8FD4BD","#8FD4BD","#8FD4BD","#8FD4BD","#8FD4BD","#8FD4BD","#8FD4BD","#8FD4BD","#7FD2AD","#7FD2AD","#7FD2AD","#7FD2AD","#7FD2AD","#7FD2AD","#7FD2AD","#7FD2AD","#7FD2AD","#7FD2AD","#7FD2AD","#7FD2AD","#7FD2AD","#7FD2AD","#7FD2AD","#7FD2AD","#9FC9A9","#9FC9A9","#9FC9A9","#9FC9A9","#9FC9A9","#9FC9A9","#9FC9A9","#9FC9A9","#9FC9A9","#9FC9A9","#B7C3AC","#B7C3AC","#B7C3AC","#B7C3AC","#B7C3AC","#B7C3AC","#B7C3AC","#B7C3AC","#D0BDAE","#D0BDAE","#D0BDAE","#D0BDAE","#D0BDAE","#D0BDAE","#D0BDAE","#D0BDAE","#D0BDAE","#D0BDAE","#D0BDAE","#D0BDAE","#E9B8B0","#ECAFB5","#ECAFB5","#ECAFB5","#ECAFB5","#ECAFB5","#ECAFB5","#ECAFB5","#ECAFB5","#DBADB8","#DBADB8","#DBADB8","#DBADB8","#DBADB8","#DBADB8","#DBADB8","#DBADB8","#DBADB8","#DBADB8","#DBADB8","#DBADB8","#DBADB8","#DBADB8","#DBADB8","#DBADB8","#CBAABB","#CBAABB","#AFA8A9","#AFA8A9","#AFA8A9","#AFA8A9","#AFA8A9","#AFA8A9","#AFA8A9","#AFA8A9","#AFA8A9","#AFA8A9","#AFA8A9","#AFA8A9","#AFA8A9","#AFA8A9","#AFA8A9","#D0B762","#D0B762","#E1BE3F","#E1BE3F","#E1BE3F","#E1BE3F","#E1BE3F","#E1BE3F","#E1BE3F","#E1BE3F","#E1BE3F","#E1BE3F","#E1BE3F","#E1BE3F","#F2C61B","#F2C61B","#F2C61B","#F2C61B","#F2C61B","#F2C61B","#F2C61B","#F2C61B","#F2C61B","#F2C61B","#F2C61B","#F2C61B","#F2C61B","#F2C61B","#F2C61B","#F2C61B","#FFCA05","#FFCA05","#FFCA05","#FFCA05","#FFCA05","#FFCA05","#FFCA05","#FFCA05","#FFA963","#FFA963","#FFA963","#FFA963","#FFA963","#FFA963","#FFA963","#FFA963","#FFA963","#FFA963","#FFA963","#FFA963","#FFA963","#FFA963","#FFA963","#FFA963","#FFA07A","#F7AC83","#F7AC83","#F7AC83","#F7AC83","#F7AC83","#F7AC83","#F7AC83","#F7AC83","#EEBE88","#EEBE88","#EEBE88","#DBE191","#DBE191","#DBE191","#D2F395","#CDF99B","#CDF99B","#D0E7A2","#DEA0BE","#E4A6B8","#E4A6B8","#E4A6B8","#E4A6B8","#E4A6B8","#E4A6B8","#E4A6B8","#EAAEB1","#EAAEB1","#FBC79C","#FACC9D","#FACC9D","#FACC9D","#FACC9D","#FACC9D","#FACC9D","#FACC9D","#F1CCA6","#F1CCA6","#F1CCA6","#E8CCB0","#E8CCB0","#DFCCB9","#DFCCB9","#DFCCB9","#DFCCB9","#DFCCB9","#DFCCB9","#D6CCC3","#D6CCC3","#D6CCC3"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","color":{"highlight":"red"},"shadow":{"enabled":true,"size":10}},"manipulation":{"enabled":false},"edges":{"arrows":{"to":{"enabled":true,"scaleFactor":0.2}},"color":{"highlight":"red"}}},"groups":null,"width":null,"height":null,"idselection":{"enabled":false},"byselection":{"enabled":false},"main":null,"submain":null,"footer":null},"evals":[],"jsHooks":[]}</script>
<p>As a further help for interpretation, you can derive a consensus tree from the posterior samples of trees using <code>summary</code>. Look in particular at the <em>support</em> column, and compare the results to the contact data.</p>
<pre class="r"><code>smry_basic &lt;- summary(res_basic)
head(smry_basic$tree)
##   from to time   support generations
## 1   NA  1  -10 0.2388060          NA
## 2    1  2    1 0.4875622           1
## 3    8  3    3 0.3980100           1
## 4    9  4    2 0.3283582           1
## 5   10  5    0 0.4975124          NA
## 6    4  6    5 0.2238806           1
tail(smry_basic$tree)
##    from to time   support generations
## 45   48 45   29 0.2288557           1
## 46   49 46   32 0.2636816           1
## 47   34 47   31 0.5273632           1
## 48    6 48   25 0.1840796           1
## 49   30 49   37 0.3880597           1
## 50   21 50   36 0.1890547           1
hist(smry_basic$tree$support, col = &quot;grey&quot;, border = &quot;white&quot;,
     main = &quot;Consensus ancestry: support&quot;, xlim = c(0,1))</code></pre>
<p><img src="/post/2017-11-22-sim-ebola-reconstruction_files/figure-html/outbreaker-basic-summary-1.png" width="672" /></p>
<p><font class="question">How would you interpret the results? Is this what you would have expected?</font></p>
<p>As a point of comparison, repeat the same analysis using temporal data only, and plot a graph of ancestries (<code>type = &quot;alpha&quot;</code>); you should obtain something along the lines of:</p>
<pre class="r"><code>set.seed(0)

data &lt;- outbreaker_data(dates = linelist$onset, # dates of onset
                        w_dens = gt$d(1:100), # generation time distribution
                        f_dens = incub$d(1:100) # incubation period distribution
                        )
res_time &lt;- outbreaker(data = data, config = config)
plot(res_time, type = &quot;alpha&quot;, burn = 500)</code></pre>
<p><img src="/post/2017-11-22-sim-ebola-reconstruction_files/figure-html/outbreaker-time-1.png" width="672" /></p>
<p><font class="question">What is the usefulness of temporal and genetic data for outbreak reconstruction? What other data would you ideally include?</font></p>
</div>
<div id="adding-contact-data-to-the-reconstruction-process" class="section level2">
<h2>Adding contact data to the reconstruction process</h2>
<p>Contact data currently contains case labels. While <code>epicontacts</code> objects will soon be accepted as inputs in <code>outbreaker2</code>, for now we need to operate some minor transformations to define contacts using cases indices rather than labels:</p>
<pre class="r"><code>ctd &lt;- matrix(match(unlist(x$contacts), linelist$case_id), ncol = 2)
head(ctd)
##      [,1] [,2]
## [1,]    6   28
## [2,]    1   15
## [3,]   30   46
## [4,]    4   23
## [5,]    4   13
## [6,]   41   43
dim(ctd)
## [1] 36  2</code></pre>
<p>All inputs to the <code>outbreaker</code> function are prepared using dedicated functions, which make a number of checks on provided inputs and define defaults:</p>
<pre class="r"><code>data &lt;- outbreaker_data(dates = linelist$onset, # dates of onset
                        dna = unname(dna), # dna sequences
                        ctd = ctd, # contact data
                        w_dens = gt$d(1:100), # generation time distribution
                        f_dens = incub$d(1:100) # incubation period distribution
                        )</code></pre>
<p>We are now ready to run the analysis. This may take a couple of minutes, depending on your computer:</p>
<pre class="r"><code>set.seed(0)
res_full &lt;- outbreaker(data = data, config = config)
res_full
## 
## 
##  ///// outbreaker results ///
## 
## class:  outbreaker_chains data.frame
## dimensions 201 rows,  158 columns
## ancestries not shown: alpha_1 - alpha_50
## infection dates not shown: t_inf_1 - t_inf_50
## intermediate generations not shown: kappa_1 - kappa_50
## 
## /// head //
##   step       post       like    prior           mu pi       eps
## 1    1 -2110.0254 -2112.3278 2.302485 1.000000e-04  1 0.5000000
## 2   50  -878.4386  -880.7412 2.302534 5.127995e-05  1 0.7440996
## 3  100  -859.4105  -861.7130 2.302546 3.897703e-05  1 0.5368811
##        lambda
## 1 0.050000000
## 2 0.008384329
## 3 0.004316341
## 
## ...
## /// tail //
##      step      post      like    prior           mu pi       eps
## 199  9900 -841.3692 -843.6717 2.302545 3.968566e-05  1 0.7442393
## 200  9950 -845.1309 -847.4334 2.302520 6.485427e-05  1 0.6742470
## 201 10000 -837.4839 -839.7864 2.302531 5.360054e-05  1 0.6503889
##          lambda
## 199 0.001870886
## 200 0.001870886
## 201 0.001870886</code></pre>
<p>Produce graphics as in the previous model. Assess convergence, choose an appropriate burnin, visualise ancestries and the infection timelines:</p>
<p><img src="/post/2017-11-22-sim-ebola-reconstruction_files/figure-html/full_plots-1.png" width="672" /><img src="/post/2017-11-22-sim-ebola-reconstruction_files/figure-html/full_plots-2.png" width="672" /><img src="/post/2017-11-22-sim-ebola-reconstruction_files/figure-html/full_plots-3.png" width="672" /><img src="/post/2017-11-22-sim-ebola-reconstruction_files/figure-html/full_plots-4.png" width="672" /><div id="htmlwidget-3" style="width:672px;height:480px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-3">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50],"label":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50],"value":[7.54591836734694,0,6.51020408163265,5.8265306122449,0.219387755102041,6.38265306122449,0,0.489795918367347,0.127551020408163,0.23469387755102,1,0,0.0255102040816327,3.24489795918367,1,0,0,0.785714285714286,0,1,1.65816326530612,1.38775510204082,2.01530612244898,0,0,0,0.474489795918367,1,0.00510204081632653,2,0,1,0,2,0.994897959183674,0,0,0,0,0.591836734693878,1,0,0,0.00510204081632653,0.13265306122449,0,0,0.341836734693878,0,0],"color":["#CCDDFF","#BCDAEE","#ADD8DE","#9ED6CD","#8FD4BD","#7FD2AD","#86CEA7","#9FC9A9","#B7C3AC","#D0BDAE","#E9B8B0","#FDB2B3","#ECAFB5","#DBADB8","#CBAABB","#BAA7BD","#A9A4C0","#AFA8A9","#BFB085","#D0B762","#E1BE3F","#F2C61B","#FFCA05","#FFC11C","#FFB934","#FFB14B","#FFA963","#FFA07A","#F7AC83","#EEBE88","#E4CF8C","#DBE191","#D2F395","#CDF99B","#D0E7A2","#D4D5A9","#D7C4B0","#DBB2B7","#DEA0BE","#E4A6B8","#EAAEB1","#EFB6AA","#F5BFA3","#FBC79C","#FACC9D","#F1CCA6","#E8CCB0","#DFCCB9","#D6CCC3","#CDCDCD"],"shape":["dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot","dot"],"shaped":["star",null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]},"edges":{"from":[1,1,1,1,1,1,1,1,3,3,3,3,3,3,3,4,4,4,4,4,4,5,5,6,6,6,6,6,6,6,6,6,6,6,8,9,10,10,11,14,14,14,14,14,14,14,14,14,15,18,18,18,18,18,20,21,21,21,21,21,21,21,22,22,22,22,22,22,23,23,27,27,27,28,30,30,32,34,34,35,40,40,40,40,41,45,48,48,48],"to":[2,3,4,5,10,11,12,15,7,8,26,32,35,36,42,6,9,13,16,23,24,2,4,14,18,19,20,22,25,28,37,40,45,48,32,6,2,4,39,17,18,21,22,25,37,40,45,50,41,22,25,37,45,50,34,18,22,25,27,37,45,50,18,25,37,40,45,50,29,31,37,45,50,33,46,49,30,38,47,44,22,37,45,50,43,50,37,45,50],"value":[0.724489795918367,1,0.821428571428571,1,1,1,1,1,1,1,1,0.510204081632653,0.994897959183674,1,1,0.826530612244898,1,1,1,1,1,0.147959183673469,0.0714285714285714,1,0.576530612244898,1,1,0.25,0.26530612244898,1,0.11734693877551,0.0918367346938776,0.086734693877551,0.964285714285714,0.489795918367347,0.127551020408163,0.127551020408163,0.107142857142857,1,1,0.280612244897959,1,0.280612244897959,0.306122448979592,0.102040816326531,0.076530612244898,0.127551020408163,0.0714285714285714,1,0.142857142857143,0.163265306122449,0.193877551020408,0.178571428571429,0.0969387755102041,1,0.0561224489795918,0.107142857142857,0.112244897959184,1,0.13265306122449,0.122448979591837,0.102040816326531,0.0561224489795918,0.086734693877551,0.158163265306122,0.816326530612245,0.142857142857143,0.122448979591837,1,1,0.127551020408163,0.163265306122449,0.153061224489796,1,1,1,1,1,1,0.994897959183674,0.178571428571429,0.076530612244898,0.11734693877551,0.163265306122449,1,0.0969387755102041,0.0663265306122449,0.0612244897959184,0.163265306122449],"arrows":["to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to"],"color":["#CCDDFF","#CCDDFF","#CCDDFF","#CCDDFF","#CCDDFF","#CCDDFF","#CCDDFF","#CCDDFF","#ADD8DE","#ADD8DE","#ADD8DE","#ADD8DE","#ADD8DE","#ADD8DE","#ADD8DE","#9ED6CD","#9ED6CD","#9ED6CD","#9ED6CD","#9ED6CD","#9ED6CD","#8FD4BD","#8FD4BD","#7FD2AD","#7FD2AD","#7FD2AD","#7FD2AD","#7FD2AD","#7FD2AD","#7FD2AD","#7FD2AD","#7FD2AD","#7FD2AD","#7FD2AD","#9FC9A9","#B7C3AC","#D0BDAE","#D0BDAE","#E9B8B0","#DBADB8","#DBADB8","#DBADB8","#DBADB8","#DBADB8","#DBADB8","#DBADB8","#DBADB8","#DBADB8","#CBAABB","#AFA8A9","#AFA8A9","#AFA8A9","#AFA8A9","#AFA8A9","#D0B762","#E1BE3F","#E1BE3F","#E1BE3F","#E1BE3F","#E1BE3F","#E1BE3F","#E1BE3F","#F2C61B","#F2C61B","#F2C61B","#F2C61B","#F2C61B","#F2C61B","#FFCA05","#FFCA05","#FFA963","#FFA963","#FFA963","#FFA07A","#EEBE88","#EEBE88","#DBE191","#CDF99B","#CDF99B","#D0E7A2","#E4A6B8","#E4A6B8","#E4A6B8","#E4A6B8","#EAAEB1","#FACC9D","#DFCCB9","#DFCCB9","#DFCCB9"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","color":{"highlight":"red"},"shadow":{"enabled":true,"size":10}},"manipulation":{"enabled":false},"edges":{"arrows":{"to":{"enabled":true,"scaleFactor":0.2}},"color":{"highlight":"red"}}},"groups":null,"width":null,"height":null,"idselection":{"enabled":false},"byselection":{"enabled":false},"main":null,"submain":null,"footer":null},"evals":[],"jsHooks":[]}</script></p>
<p><font class="question">How would you interpret the results?</font></p>
<p><br></p>
<p>Derive a consensus tree using <code>summary</code>, and make a new <code>epicontacts</code> object, using the previous linelist, to visualise the consensus tree with meta-information:</p>
<pre class="r"><code>smry_full &lt;- summary(res_full)
head(smry_full$tree)
##   from to time   support generations
## 1   NA  1   -8        NA          NA
## 2    1  2    2 0.7313433           1
## 3    1  3    2 1.0000000           1
## 4    1  4    0 0.8159204           1
## 5    1  5    2 1.0000000           1
## 6    4  6    6 0.8258706           1

smry_full$tree$support &lt;- round(smry_full$tree$support, 2)

linelist$id &lt;- 1:nrow(linelist) # add case index to linelist
cons_tree &lt;- make_epicontacts(linelist, smry_full$tree[-1, ], id = &quot;id&quot;,
                              from = 1, to = 2, directed = TRUE)</code></pre>
<p>In the following, we add age class information to the linelist of <code>cons_tree</code>, and create color palettes which will be used to display information on the final graph:</p>
<pre class="r"><code>library(visNetwork)

support_pal &lt;- colorRampPalette(
    c(&quot;#918D98&quot;, &quot;#645877&quot;, &quot;#423359&quot;, &quot;#281449&quot;, &quot;#1A0340&quot;)
)

age_pal &lt;- colorRampPalette(
    c(&quot;#3288BD&quot;, &quot;#ABDDA4&quot;, &quot;#FDAE61&quot;, &quot;#D53E4F&quot;)
)

cons_tree$linelist$age_class &lt;- cut(cons_tree$linelist$age,
                                    breaks = c(0, 10, 20, 30, 40, 90),
                                    labels = c(&quot;0-10&quot;, &quot;11-20&quot;, &quot;21-30&quot;, &quot;31-40&quot;, &quot;41+&quot; ))</code></pre>
<p>Looking carefully at the documentation of <code>vis_epicontacts</code>, try to reproduce the final consensus tree below:</p>
<div id="htmlwidget-4" style="width:90%;height:700px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-4">{"x":{"nodes":{"id":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50],"case_id":["39e9dc","664549","b4d8aa","51883d","947e40","9aa197","e4b0a2","af0ac0","185911","601d2e","605322","e399b1","e37897","f658bc","a8e9d8","6f3c15","ae87f7","8c1fc8","8c5776","88526e","1b035f","1efd54","778316","501b8f","525dfa","b5ad13","8bed66","426b6d","a402f6","c2a389","93a3ba","99141e","3b43e6","5eb2b0","3a5305","55a452","b7faf4","4945f2","1875e2","59e66c","933811","bcfad3","99abbe","5ea757","944ba3","95fc1d","5c5c05","d5564e","ac8d9d","fea66b"],"onset":["2017-10-10","2017-10-16","2017-10-17","2017-10-18","2017-10-20","2017-10-20","2017-10-21","2017-10-21","2017-10-21","2017-10-22","2017-10-22","2017-10-23","2017-10-28","2017-10-28","2017-10-29","2017-10-29","2017-11-01","2017-11-01","2017-11-02","2017-11-03","2017-11-04","2017-11-04","2017-11-04","2017-11-05","2017-11-06","2017-11-07","2017-11-08","2017-11-08","2017-11-09","2017-11-10","2017-11-10","2017-11-12","2017-11-12","2017-11-13","2017-11-13","2017-11-14","2017-11-16","2017-11-16","2017-11-16","2017-11-16","2017-11-16","2017-11-18","2017-11-18","2017-11-19","2017-11-19","2017-11-19","2017-11-20","2017-11-20","2017-11-23","2017-11-24"],"sex":["female","male","male","male","female","female","female","male","female","male","female","female","female","male","female","male","male","male","female","female","male","male","female","male","female","female","female","female","male","female","male","male","male","female","male","female","female","male","male","male","male","female","male","male","female","female","female","female","female","male"],"age":[62,28,54,57,23,66,13,10,34,11,23,23,9,68,37,13,25,28,7,20,29,8,10,23,10,21,29,7,26,26,7,15,28,7,29,33,10,19,30,9,16,31,14,24,30,15,21,43,5,18],"age_class":["41+","21-30","41+","41+","21-30","41+","11-20","0-10","31-40","11-20","21-30","21-30","0-10","41+","31-40","11-20","21-30","21-30","0-10","11-20","21-30","0-10","0-10","21-30","0-10","21-30","21-30","0-10","21-30","21-30","0-10","11-20","21-30","0-10","21-30","31-40","0-10","11-20","21-30","0-10","11-20","31-40","11-20","21-30","21-30","11-20","21-30","41+","0-10","11-20"],"label":["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50"],"title":["<p> id: 1<br>case_id: 39e9dc<br>onset: 2017-10-10<br>sex: female<br>age: 62<br>age_class: 41+ <\/p>","<p> id: 2<br>case_id: 664549<br>onset: 2017-10-16<br>sex: male<br>age: 28<br>age_class: 21-30 <\/p>","<p> id: 3<br>case_id: b4d8aa<br>onset: 2017-10-17<br>sex: male<br>age: 54<br>age_class: 41+ <\/p>","<p> id: 4<br>case_id: 51883d<br>onset: 2017-10-18<br>sex: male<br>age: 57<br>age_class: 41+ <\/p>","<p> id: 5<br>case_id: 947e40<br>onset: 2017-10-20<br>sex: female<br>age: 23<br>age_class: 21-30 <\/p>","<p> id: 6<br>case_id: 9aa197<br>onset: 2017-10-20<br>sex: female<br>age: 66<br>age_class: 41+ <\/p>","<p> id: 7<br>case_id: e4b0a2<br>onset: 2017-10-21<br>sex: female<br>age: 13<br>age_class: 11-20 <\/p>","<p> id: 8<br>case_id: af0ac0<br>onset: 2017-10-21<br>sex: male<br>age: 10<br>age_class: 0-10 <\/p>","<p> id: 9<br>case_id: 185911<br>onset: 2017-10-21<br>sex: female<br>age: 34<br>age_class: 31-40 <\/p>","<p> id: 10<br>case_id: 601d2e<br>onset: 2017-10-22<br>sex: male<br>age: 11<br>age_class: 11-20 <\/p>","<p> id: 11<br>case_id: 605322<br>onset: 2017-10-22<br>sex: female<br>age: 23<br>age_class: 21-30 <\/p>","<p> id: 12<br>case_id: e399b1<br>onset: 2017-10-23<br>sex: female<br>age: 23<br>age_class: 21-30 <\/p>","<p> id: 13<br>case_id: e37897<br>onset: 2017-10-28<br>sex: female<br>age: 9<br>age_class: 0-10 <\/p>","<p> id: 14<br>case_id: f658bc<br>onset: 2017-10-28<br>sex: male<br>age: 68<br>age_class: 41+ <\/p>","<p> id: 15<br>case_id: a8e9d8<br>onset: 2017-10-29<br>sex: female<br>age: 37<br>age_class: 31-40 <\/p>","<p> id: 16<br>case_id: 6f3c15<br>onset: 2017-10-29<br>sex: male<br>age: 13<br>age_class: 11-20 <\/p>","<p> id: 17<br>case_id: ae87f7<br>onset: 2017-11-01<br>sex: male<br>age: 25<br>age_class: 21-30 <\/p>","<p> id: 18<br>case_id: 8c1fc8<br>onset: 2017-11-01<br>sex: male<br>age: 28<br>age_class: 21-30 <\/p>","<p> id: 19<br>case_id: 8c5776<br>onset: 2017-11-02<br>sex: female<br>age: 7<br>age_class: 0-10 <\/p>","<p> id: 20<br>case_id: 88526e<br>onset: 2017-11-03<br>sex: female<br>age: 20<br>age_class: 11-20 <\/p>","<p> id: 21<br>case_id: 1b035f<br>onset: 2017-11-04<br>sex: male<br>age: 29<br>age_class: 21-30 <\/p>","<p> id: 22<br>case_id: 1efd54<br>onset: 2017-11-04<br>sex: male<br>age: 8<br>age_class: 0-10 <\/p>","<p> id: 23<br>case_id: 778316<br>onset: 2017-11-04<br>sex: female<br>age: 10<br>age_class: 0-10 <\/p>","<p> id: 24<br>case_id: 501b8f<br>onset: 2017-11-05<br>sex: male<br>age: 23<br>age_class: 21-30 <\/p>","<p> id: 25<br>case_id: 525dfa<br>onset: 2017-11-06<br>sex: female<br>age: 10<br>age_class: 0-10 <\/p>","<p> id: 26<br>case_id: b5ad13<br>onset: 2017-11-07<br>sex: female<br>age: 21<br>age_class: 21-30 <\/p>","<p> id: 27<br>case_id: 8bed66<br>onset: 2017-11-08<br>sex: female<br>age: 29<br>age_class: 21-30 <\/p>","<p> id: 28<br>case_id: 426b6d<br>onset: 2017-11-08<br>sex: female<br>age: 7<br>age_class: 0-10 <\/p>","<p> id: 29<br>case_id: a402f6<br>onset: 2017-11-09<br>sex: male<br>age: 26<br>age_class: 21-30 <\/p>","<p> id: 30<br>case_id: c2a389<br>onset: 2017-11-10<br>sex: female<br>age: 26<br>age_class: 21-30 <\/p>","<p> id: 31<br>case_id: 93a3ba<br>onset: 2017-11-10<br>sex: male<br>age: 7<br>age_class: 0-10 <\/p>","<p> id: 32<br>case_id: 99141e<br>onset: 2017-11-12<br>sex: male<br>age: 15<br>age_class: 11-20 <\/p>","<p> id: 33<br>case_id: 3b43e6<br>onset: 2017-11-12<br>sex: male<br>age: 28<br>age_class: 21-30 <\/p>","<p> id: 34<br>case_id: 5eb2b0<br>onset: 2017-11-13<br>sex: female<br>age: 7<br>age_class: 0-10 <\/p>","<p> id: 35<br>case_id: 3a5305<br>onset: 2017-11-13<br>sex: male<br>age: 29<br>age_class: 21-30 <\/p>","<p> id: 36<br>case_id: 55a452<br>onset: 2017-11-14<br>sex: female<br>age: 33<br>age_class: 31-40 <\/p>","<p> id: 37<br>case_id: b7faf4<br>onset: 2017-11-16<br>sex: female<br>age: 10<br>age_class: 0-10 <\/p>","<p> id: 38<br>case_id: 4945f2<br>onset: 2017-11-16<br>sex: male<br>age: 19<br>age_class: 11-20 <\/p>","<p> id: 39<br>case_id: 1875e2<br>onset: 2017-11-16<br>sex: male<br>age: 30<br>age_class: 21-30 <\/p>","<p> id: 40<br>case_id: 59e66c<br>onset: 2017-11-16<br>sex: male<br>age: 9<br>age_class: 0-10 <\/p>","<p> id: 41<br>case_id: 933811<br>onset: 2017-11-16<br>sex: male<br>age: 16<br>age_class: 11-20 <\/p>","<p> id: 42<br>case_id: bcfad3<br>onset: 2017-11-18<br>sex: female<br>age: 31<br>age_class: 31-40 <\/p>","<p> id: 43<br>case_id: 99abbe<br>onset: 2017-11-18<br>sex: male<br>age: 14<br>age_class: 11-20 <\/p>","<p> id: 44<br>case_id: 5ea757<br>onset: 2017-11-19<br>sex: male<br>age: 24<br>age_class: 21-30 <\/p>","<p> id: 45<br>case_id: 944ba3<br>onset: 2017-11-19<br>sex: female<br>age: 30<br>age_class: 21-30 <\/p>","<p> id: 46<br>case_id: 95fc1d<br>onset: 2017-11-19<br>sex: female<br>age: 15<br>age_class: 11-20 <\/p>","<p> id: 47<br>case_id: 5c5c05<br>onset: 2017-11-20<br>sex: female<br>age: 21<br>age_class: 21-30 <\/p>","<p> id: 48<br>case_id: d5564e<br>onset: 2017-11-20<br>sex: female<br>age: 43<br>age_class: 41+ <\/p>","<p> id: 49<br>case_id: ac8d9d<br>onset: 2017-11-23<br>sex: female<br>age: 5<br>age_class: 0-10 <\/p>","<p> id: 50<br>case_id: fea66b<br>onset: 2017-11-24<br>sex: male<br>age: 18<br>age_class: 11-20 <\/p>"],"icon.color":["#D53E4F","#D4C582","#D53E4F","#D53E4F","#D4C582","#D53E4F","#8CC7AA","#3288BD","#F3925C","#8CC7AA","#D4C582","#D4C582","#3288BD","#D53E4F","#F3925C","#8CC7AA","#D4C582","#D4C582","#3288BD","#8CC7AA","#D4C582","#3288BD","#3288BD","#D4C582","#3288BD","#D4C582","#D4C582","#3288BD","#D4C582","#D4C582","#3288BD","#8CC7AA","#D4C582","#3288BD","#D4C582","#F3925C","#3288BD","#8CC7AA","#D4C582","#3288BD","#8CC7AA","#F3925C","#8CC7AA","#D4C582","#D4C582","#8CC7AA","#D4C582","#D53E4F","#3288BD","#8CC7AA"],"group.color":["#D53E4F","#D4C582","#D53E4F","#D53E4F","#D4C582","#D53E4F","#8CC7AA","#3288BD","#F3925C","#8CC7AA","#D4C582","#D4C582","#3288BD","#D53E4F","#F3925C","#8CC7AA","#D4C582","#D4C582","#3288BD","#8CC7AA","#D4C582","#3288BD","#3288BD","#D4C582","#3288BD","#D4C582","#D4C582","#3288BD","#D4C582","#D4C582","#3288BD","#8CC7AA","#D4C582","#3288BD","#D4C582","#F3925C","#3288BD","#8CC7AA","#D4C582","#3288BD","#8CC7AA","#F3925C","#8CC7AA","#D4C582","#D4C582","#8CC7AA","#D4C582","#D53E4F","#3288BD","#8CC7AA"],"shape":["icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon","icon"],"icon.code":["f182","f183","f183","f183","f182","f182","f182","f183","f182","f183","f182","f182","f182","f183","f182","f183","f183","f183","f182","f182","f183","f183","f182","f183","f182","f182","f182","f182","f183","f182","f183","f183","f183","f182","f183","f182","f182","f183","f183","f183","f183","f182","f183","f183","f182","f182","f182","f182","f182","f183"]},"edges":{"from":[1,1,1,1,4,3,3,4,1,1,1,4,6,1,4,14,6,6,6,14,14,4,4,14,3,21,6,23,32,23,3,28,20,3,3,18,34,11,22,15,3,41,35,18,30,34,6,30,40],"to":[2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50],"time":[2,2,0,2,6,8,8,6,3,6,5,12,11,11,13,18,17,17,16,18,21,14,17,22,19,25,17,24,26,26,18,28,25,22,21,31,33,27,30,25,28,35,34,33,35,35,29,37,38],"support":[0.73,1,0.82,1,0.83,1,1,1,1,1,1,1,1,1,1,1,0.57,1,1,0.99,0.27,1,1,0.3,1,0.99,1,1,1,1,0.5,1,1,0.99,1,0.2,0.99,1,0.81,1,0.99,1,0.99,0.17,1,1,0.96,1,0.16],"generations":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"width":[3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],"arrows":["to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to","to"],"label":[0.73,1,0.82,1,0.83,1,1,1,1,1,1,1,1,1,1,1,0.57,1,1,0.99,0.27,1,1,0.3,1,0.99,1,1,1,1,0.5,1,1,0.99,1,0.2,0.99,1,0.81,1,0.99,1,0.99,0.17,1,1,0.96,1,0.16],"color":["#3E2E56","#1A0340","#2E1B4C","#1A0340","#261248","#1A0340","#1A0340","#1A0340","#1A0340","#1A0340","#1A0340","#1A0340","#1A0340","#1A0340","#1A0340","#1A0340","#47385D","#1A0340","#1A0340","#1E0842","#675C79","#1A0340","#1A0340","#5C4F70","#1A0340","#1E0842","#1A0340","#1A0340","#1A0340","#1A0340","#514466","#1A0340","#1A0340","#1E0842","#1A0340","#756C83","#1E0842","#1A0340","#362451","#1A0340","#1E0842","#1A0340","#1E0842","#837C8D","#1A0340","#1A0340","#220D45","#1A0340","#918D98"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false},"physics":{"stabilization":false}},"groups":["#D53E4F","#D4C582","#8CC7AA","#3288BD","#F3925C"],"width":"90%","height":"700px","idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true},"byselection":{"enabled":true,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","variable":"age_class","values":["0-10","11-20","21-30","31-40","41+"]},"main":null,"submain":null,"footer":null,"legend":{"width":0.2,"useGroups":false,"position":"left","ncol":1,"stepX":100,"stepY":100,"nodes":{"label":["0-10","11-20","21-30","31-40","41+"],"color":["#3288BD","#8CC7AA","#D4C582","#F3925C","#D53E4F"],"shape":["box","box","box","box","box"],"shadow":[true,true,true,true,true],"font.size":[20,20,20,20,20]},"nodesToDataframe":true},"highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null},"iconsRedraw":true},"evals":[],"jsHooks":[]}</script>
<p><font class="question">What are your conclusions? What are the main drivers of this outbreak? What recommendations would you make to further improve the response?</font></p>
</div>
</div>
<div id="about-this-document" class="section level1">
<h1>About this document</h1>
<div id="contributors" class="section level2">
<h2>Contributors</h2>
<ul>
<li>Thibaut Jombart: initial version</li>
</ul>
<p>Contributions are welcome via <a href="https://github.com/reconhub/learn/pulls">pull requests</a>. The source file is hosted on <a href="https://github.com/reconhub/learn/blob/master/content/post/2017-11-22-sim-ebola-reconstruction.Rmd">github</a>.</p>
</div>
<div id="legal-stuff" class="section level2">
<h2>Legal stuff</h2>
<p><strong>License</strong>: <a href="https://creativecommons.org/licenses/by/3.0/">CC-BY</a> <strong>Copyright</strong>: Thibaut Jombart, 2017</p>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1>References</h1>
<div id="refs" class="references">
<div id="ref-Cori2013-fc">
<p>Cori, Anne, Neil M Ferguson, Christophe Fraser, and Simon Cauchemez. 2013. “A New Framework and Software to Estimate Time-Varying Reproduction Numbers During Epidemics.” <em>Am. J. Epidemiol.</em> 178 (9): 1505–12.</p>
</div>
<div id="ref-Jombart2014-ab">
<p>Jombart, Thibaut, Anne Cori, Xavier Didelot, Simon Cauchemez, Christophe Fraser, and Neil Ferguson. 2014. “Bayesian Reconstruction of Disease Outbreaks by Combining Epidemiologic and Genomic Data.” <em>PLoS Comput. Biol.</em> 10 (1): e1003457.</p>
</div>
<div id="ref-WHO_Ebola_Response_Team2014-mr">
<p>WHO Ebola Response Team. 2014. “Ebola Virus Disease in West Africa–the First 9 Months of the Epidemic and Forward Projections.” <em>N. Engl. J. Med.</em> 371 (16): 1481–95.</p>
</div>
</div>
</div>

      </div>
    </div>
  </div>

  <hr/>
  

</div>

          </div>
        </div>
        <div class="row site-footer">
          <div class="col-md-12">
            <div class="row">
  <div class="col-md-12 footer-title">
    <h3 style="color:black">Powered by</h3>
    <a href="http://www.repidemicsconsortium.org/"><img src="/img/logo/recon.png" width="150px"></a>
      
      
      
      
      
  </div>
</div>

















































<script src="//yihui.name/js/math-code.js"></script>
<script async
	src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">
</script>

          </div>
        </div>
      </div>
    </div>
    <script src="https://reconlearn.netlify.com/js/jquery.min.js"></script>
<script src="https://reconlearn.netlify.com/js/bootstrap.min.js"></script>
<script src="https://reconlearn.netlify.com/js/jquery.cookie.js"> </script>
<script src="https://reconlearn.netlify.com/js/ekko-lightbox.js"></script>
<script src="https://reconlearn.netlify.com/js/jquery.scrollTo.min.js"></script>
<script src="https://reconlearn.netlify.com/js/masonry.pkgd.min.js"></script>
<script src="https://reconlearn.netlify.com/js/imagesloaded.pkgd.min.js"></script>
<script src="https://reconlearn.netlify.com/js/owl.carousel.min.js"></script>
<script src="https://reconlearn.netlify.com/js/front.js"></script>

  </body>
</html>
